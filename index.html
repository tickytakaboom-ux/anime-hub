<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AnimeHub</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9ca3af; --accent:#06b6d4;
      --glass: rgba(255,255,255,0.04);
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:linear-gradient(180deg,#0b1220 0%, #061226 100%); color:#e6eef6; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
    .container{max-width:1100px; margin:32px auto; padding:20px;}
    header{display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:18px;}
    h1{font-size:28px; margin:0}
    p.lead{color:var(--muted); margin:6px 0 0; font-size:14px}
    .controls{display:flex; gap:10px; align-items:center;}
    input.search{padding:10px 12px 10px 36px; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:var(--glass); color:inherit; min-width:220px;}
    .select, .select-sm{padding:9px 10px; border-radius:8px; background:transparent; border:1px solid rgba(255,255,255,0.06); color:inherit;}
    .grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:16px; margin-top:18px;}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.06)); border-radius:12px; overflow:hidden; box-shadow: 0 6px 18px rgba(2,6,23,0.6); transition:transform .12s ease, box-shadow .12s ease;}
    .card:hover{transform:translateY(-6px); box-shadow:0 12px 30px rgba(2,6,23,0.8);}
    .card img{width:100%; height:300px; object-fit:cover; display:block; background:#111}
    .card-body{padding:12px;}
    .meta{display:flex; justify-content:space-between; align-items:center; gap:8px; color:var(--muted); font-size:13px}
    .title{font-weight:700; margin:8px 0 6px; font-size:16px}
    .genres{font-size:12px; color:var(--muted);}
    .btn{background:var(--accent); color:#052226; padding:8px 10px; border-radius:8px; border:none; cursor:pointer; font-weight:700;}
    .rating{background:rgba(0,0,0,0.45); padding:6px 8px; border-radius:8px; font-weight:700; font-size:13px;}
    .fav-btn{
      background:transparent;
      border:1px solid rgba(255,255,255,0.06);
      color:var(--accent);
      padding:6px 8px;
      border-radius:8px;
      cursor:pointer;
      font-weight:700;
      font-size:14px;
    }
	.select option, .select-sm option {color: #e6eef6;background-color: #0b1220
	}
	header {
	  display: flex;
	  align-items: center;
	  justify-content: space-between;
	  gap: 16px;
	  margin-bottom: 18px;

	  position: sticky; 
	  top: 0;             
	  z-index: 100;     
	  background: linear-gradient(180deg, rgba(11,18,32,0.95) 0%, rgba(6,18,38,0.95) 100%);
	  backdrop-filter: blur(6px); 
	}
	header {
	  transition: box-shadow 0.2s ease, background 0.2s ease;
	}
	header.sticky {
	  box-shadow: 0 4px 20px rgba(0,0,0,0.6);
	}
	header {
	  width: 100%;
	  padding: 40px 40px;
	  box-sizing: border-box;
	}
    /* modal */
    .modal-backdrop{position:fixed; inset:0; background:linear-gradient(90deg, rgba(2,6,23,0.6), rgba(2,6,23,0.85)); display:flex; align-items:center; justify-content:center; z-index:80; padding:20px;}
    .modal{max-width:900px; width:100%; background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.06)); border-radius:12px; padding:18px; display:flex; gap:16px; color:inherit;}
    .modal img{width:220px; height:320px; object-fit:cover; border-radius:8px}
    .modal .info{flex:1}
    .close{background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted); padding:6px 8px; border-radius:8px; cursor:pointer;}
    footer{text-align:center; color:var(--muted); margin-top:24px; font-size:13px}
    /* small screens */
    @media (max-width:720px){
      header{flex-direction:column; align-items:flex-start}
      .controls{width:100%; margin-top:10px; flex-wrap:wrap}
      .card img{height:220px}
      .modal{flex-direction:column; align-items:center}
      .modal img{width:180px; height:260px}
    }
    /* search icon */
    .search-wrap{position:relative}
    .search-wrap svg{position:absolute; left:10px; top:50%; transform:translateY(-50%); opacity:0.8}
	#backToTop {
	  position: fixed;
	  bottom: 22px;
	  right: 22px;
	  padding: 10px 14px;
	  font-size: 16px;
	  border-radius: 10px;
	  background: var(--accent);
	  color: #052226;
	  border: none;
	  cursor: pointer;
	  font-weight: 700;
	  display: none;
	  box-shadow: 0 6px 20px rgba(0,0,0,0.4);
	  transition: opacity .2s ease, transform .2s ease;
	}
	#backToTop.show {
	  display: block;
	  opacity: 1;
	  transform: translateY(0);
	}
	#backToTop.hide {
	  opacity: 0;
	  transform: translateY(10px);
	}
	@keyframes fadeUp {
	  0% {
		opacity: 0;
		transform: translateY(20px);
	  }
	  100% {
		opacity: 1;
		transform: translateY(0);
	  }
	}

	.card {
	  animation: fadeUp 0.4s ease forwards;
	}
	#authContainer {
	  display: flex;
	  gap: 8px;
	  align-items: center;
	  background: rgba(255,255,255,0.05);
	  padding: 6px 12px;
	  border-radius: 12px;
	  backdrop-filter: blur(4px);
	}

	#authContainer input {
	  padding: 6px 10px;
	  border-radius: 8px;
	  border: 1px solid rgba(255,255,255,0.1);
	  background: rgba(0,0,0,0.2);
	  color: #e6eef6;
	  outline: none;
	  font-size: 14px;
	  height: 36px;
	}

	#authContainer button {
	  padding: 0px 12px;
	  border-radius: 8px;
	  border: none;
	  cursor: pointer;
	  background: var(--accent);
	  color: #052226;
	  font-weight: 700;
	  transition: 0.2s;
	  height: 36px;
	}

	#authContainer button:hover {
	  background: #0fc1e5;
	}
	header {
	  padding: 20px 40px; /* au lieu de 40px */
	  flex-wrap: wrap;     /* permet aux éléments de descendre si besoin */
	}

	#authContainer {
	  display: flex;
	  gap: 8px;
	  align-items: center;
	  flex-wrap: wrap;     /* pour que les inputs passent à la ligne sur mobile */
	}
	@media (max-width:720px){
	  #authContainer {
		width: 100%;
		justify-content: flex-start;
	  }
	  #authContainer input {
		flex: 1;  /* prend toute la largeur dispo */
	  }
	  #authContainer button {
		flex-shrink: 0;
	  }
	}
  </style>
</head>
<body>
    <header>
      <div>
        <h1>AnimeHub</h1>
        <p class="lead">Ton univers anime à portée de clic</p>
      </div>
      <div class="controls">
        <div class="search-wrap">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M21 21l-4.35-4.35" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="11" cy="11" r="6" stroke="#9ca3af" stroke-width="2"></circle></svg>
          <input id="search" class="search" placeholder="Rechercher un anime..." />
        </div>
        <select id="genre" class="select">
        </select>
        <select id="sort" class="select-sm">
          <option value="top">Top rating</option>
          <option value="new">Les plus récents</option>
		  <option value="az">Alphabétique (A → Z)</option>
		  <option value="za">Alphabétique (Z → A)</option>
        </select>
        <select id="favFilter" class="select-sm">
          <option value="all">Tous</option>
          <option value="fav">Favoris seulement</option>
        </select>
      </div>
	  <div id="authContainer">
		<input type="email" id="email" placeholder="Email">
		<input type="password" id="password" placeholder="Mot de passe">
		<button id="signupBtn">S'inscrire</button>
		<button id="loginBtn">Connexion</button>
		<button id="logoutBtn" style="display:none">Déconnexion</button>
	  </div>
    </header>
	<div class="container">
    <main>
      <div id="grid" class="grid"></div>
      <div id="empty" style="display:none; color:var(--muted); text-align:center; padding:40px 0;">Aucun résultat...</div>
    </main>

    <footer>Il manque ton anime ? N'hésite pas à demander pour que je le rajoute.</footer>
  </div>

  <!-- Modal template -->
  <div id="modalRoot" style="display:none"></div>
  <button id="backToTop">↑ Top</button>

  <script>
    const SAMPLE_ANIMES = [
      { id:1, 
	  title:'One Piece', 
	  genre:['Adventure','Action'], 
	  rating:8.9, 
	  year:1999, 
	  img:'https://cdn.myanimelist.net/images/anime/1244/138851.jpg', 
	  summary:'One Piece suit Monkey D. Luffy, un ado qui veut devenir Roi des Pirates après avoir mangé un fruit magique qui rend son corps élastique. Il part sur les mers pour trouver le légendaire trésor, le One Piece, et se crée petit à petit un équipage aux pouvoirs et aux rêves différents, les Mugiwara. Ensemble, ils affrontent des pirates, des marines, des tyrans et des monstres, tout en vivant des aventures incroyables et en se rapprochant de la vérité sur le monde et sur le passé caché.', 
	  fav:false },
      { id:2, title:'Solo Leveling', 
	  genre:['Action','Fantasy'], 
	  rating:7.7, 
	  year:2024, 
	  img:'https://cdn.myanimelist.net/images/anime/1448/147351.jpg', 
	  summary:'Dans un monde où des portails font apparaître des monstres, les humains “chasseurs” risquent leur vie pour les affronter. Sung Jin-Woo, considéré comme le chasseur le plus faible, survit par miracle à un donjon terrifiant. Après ça, il reçoit un pouvoir unique : il peut devenir plus fort sans limite, comme dans un jeu vidéo, en accomplissant des quêtes et en gagnant des niveaux. À partir de là, Jin-Woo grimpe en puissance à une vitesse folle, affronte des ennemis de plus en plus dangereux, et découvre les secrets derrière les portails et sa propre ascension.', 
	  fav:false },
      { id:3, 
	  title:'Death Note', 
	  genre:['Mystery','Thriller'], 
	  rating:9.9, 
	  year:2006, 
	  img:'https://cdn.myanimelist.net/images/anime/1079/138100.jpg', 
	  summary:'Death Note raconte l’histoire de Light Yagami, un étudiant japonais brillant mais désabusé, qui trouve un carnet surnaturel appelé Death Note. Ce carnet permet de tuer toute personne dont on écrit le nom dedans. Convaincu qu’il peut créer un monde parfait en éliminant les criminels, Light se transforme en justicier impitoyable sous le nom de Kira. Face à lui, L, un détective génial et mystérieux, se lance dans une lutte intellectuelle intense pour l’arrêter. Entre manipulations, trahisons et stratégies mentales, le combat entre Light et L devient une véritable partie d’échecs mortelle.', 
	  fav:false },
      { id:4, 
	  title:'Jujutsu Kaisen', 
	  genre:['Action','Supernatural'], 
	  rating:8.4, 
	  year:2020, 
	  img:'https://cdn.myanimelist.net/images/anime/1180/153379.jpg', 
	  summary:'L’histoire suit Yuji Itadori, un lycéen super sportif qui découvre un monde caché rempli de malédictions, des esprits créés par les émotions négatives des humains. Quand il avale un doigt maudit contenant une puissante malédiction, Ryomen Sukuna, il devient son hôte. Yuji rejoint alors l’école de Jujutsu, où il apprend à combattre les malédictions avec ses nouveaux pouvoirs, tout en essayant de protéger les innocents et de découvrir comment vaincre Sukuna définitivement.', 
	  fav:false },
      { id:5, 
	  title:'Oshi No Ko', 
	  genre:['Drama','Mystery'], 
	  rating:8.1, 
	  year:2023, 
	  img:'https://cdn.myanimelist.net/images/anime/1979/153329.jpg', 
	  summary:'L’histoire suit Aquamarine “Aqua” et Ruby, des jumeaux nés dans l’industrie du divertissement après une série d’événements tragiques liés à leur mère, une idole populaire. Le manga explore les coulisses sombres du showbiz, les ambitions, les manipulations et les secrets des célébrités, tout en suivant leur quête de justice et de vérité sur le passé de leur famille.', 
	  fav:false },
	  { id:6,
	  title:'Fairy Tail',
	  genre:['Action','Adventure','Fantasy'],
	  rating:5.7,
	  year:2009,
	  img:'https://cdn.myanimelist.net/images/anime/5/18179.jpg',
	  summary:`L'histoire suit Natsu Dragnir, un mage de feu, et ses amis de la guilde Fairy Tail, connus pour leur énergie, leur courage et leur sens de la camaraderie. Ensemble, ils accomplissent des missions, affrontent des ennemis redoutables et découvrent des secrets sur le monde et sur eux-mêmes. Au fil des aventures, l’anime met surtout l’accent sur l’amitié, la persévérance et la magie spectaculaire, avec des combats intenses et des moments émouvants qui renforcent les liens entre les personnages.`,
	  fav:false },
	  { id:7,
	  title:'Shangri-La Frontier',
	  genre:['Isekai','Fantasy','Game'],
	  rating:5.4,
	  year:2023,
	  img:'https://cdn.myanimelist.net/images/anime/1851/148885.jpg',
	  summary:`L'histoire suit Sunraku, un gamer hardcore qui adore les jeux vidéo tout buggés. Un jour, il décide de tester Shangri-La Frontier, un VRMMORPG extrêmement populaire et bien fait. Grâce à son expérience dans des jeux “horribles”, Sunraku devient incroyablement fort dans ce monde virtuel. Il se lance alors dans une aventure pleine de boss légendaires, de défis absurdes, de rencontres marquantes et de moments très drôles, tout en essayant de percer les secrets du jeu.`,
	  fav:false },
	  { id:8,
	  title:'My Hero Academia',
	  genre:['Superheroes','Action'],
	  rating:7.3,
	  year:2016,
	  img:'https://cdn.myanimelist.net/images/anime/1959/151055.jpg',
	  summary:'Dans un monde où presque tout le monde possède un pouvoir appelé Alter, Izuku Midoriya naît… sans aucun pouvoir. Son rêve pourtant : devenir un grand héros comme son idole All Might. Sa vie bascule quand All Might lui transmet son Alter, One For All. Izuku intègre alors l’école de héros UA, où il s’entraîne avec d’autres élèves pour devenir pro, affronte des vilains de plus en plus dangereux et découvre les secrets derrière son nouveau pouvoir.',
	  fav:false },
	  { id:9,
	  title:`L'Attaque Des Titans`,
	  genre:['Dark Fantasy','Action','Drama'],
	  rating:9.9,
	  year:2013,
	  img:'https://cdn.myanimelist.net/images/anime/1279/131078.jpg',
	  summary:'L’histoire suit Eren Yeager, qui vit dans une cité entourée de gigantesques murs pour protéger l’humanité des Titans, des créatures qui dévorent les humains. Après que sa ville est détruite et que sa mère meurt, Eren jure d’exterminer tous les Titans. Il rejoint alors l’armée avec Mikasa et Armin, et découvre peu à peu la vérité : les Titans, les murs, le monde extérieur… rien n’est vraiment comme on le leur a raconté. L’histoire devient une montée en tension entre guerre, secrets et survie, où chaque révélation change totalement la vision du monde.',
	  fav:false }
	];
	
	
	const genreEl = document.getElementById('genre');
	const sortEl = document.getElementById('sort');
	const favFilterEl = document.getElementById('favFilter');
	const grid = document.getElementById('grid');
	const searchInput = document.getElementById('search');
	const empty = document.getElementById('empty');
	const modalRoot = document.getElementById('modalRoot');

	// Charger favoris depuis localStorage
	const storedFavs = JSON.parse(localStorage.getItem('animeFavs') || '{}');
	SAMPLE_ANIMES.forEach(a => { if(storedFavs[a.id]) a.fav = true; });

	// Remplir select genres
	const genres = new Set(['Tout']);
	SAMPLE_ANIMES.forEach(a => a.genre.forEach(g => genres.add(g)));
	genres.forEach(g => { const o = document.createElement('option'); o.textContent=o.value=g; genreEl.appendChild(o); });
	
	const ITEMS_PER_LOAD = 6; // combien de cartes à charger à chaque fois
	let currentIndex = 0; // index de départ pour le rendu
	let filteredList = []; // liste filtrée après recherche/tri


	function renderList(list){
	  grid.innerHTML = '';
	  if(!list.length){ empty.style.display='block'; return; }
	  empty.style.display='none';

	  list.forEach((a, index) => {
		  const card = document.createElement('div'); 
		  card.className = 'card';
		  card.style.animationDelay = `${index * 0.08}s`; // 0.08s entre chaque carte
		  card.innerHTML = `
			<img src="${a.img}" alt="${a.title}">
			<div class="card-body">
			  <div class="meta"><div class="genres">${a.genre.join(' • ')}</div><div class="rating">${a.rating.toFixed(1)}</div></div>
			  <div class="title">${a.title}</div>
			  <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px;">
				<div style="color:var(--muted); font-size:13px">${a.year}</div>
				<div style="display:flex; gap:6px;">
				  <button class="fav-btn" data-id="${a.id}">${a.fav?'★':'☆'}</button>
				  <button class="btn" data-id="${a.id}">Voir</button>
				</div>
			  </div>
			</div>`;
		  grid.appendChild(card);
		});
	  // Modale et favoris
	  grid.querySelectorAll('.btn').forEach(b => b.addEventListener('click', ()=>openModal(SAMPLE_ANIMES.find(a=>a.id==b.dataset.id))));
	  grid.querySelectorAll('.fav-btn').forEach(b => b.addEventListener('click', e=>{
		e.stopPropagation(); toggleFavorite(Number(b.dataset.id));
	  }));
	}
	function renderNextBatch() {
	  const grid = document.getElementById('grid');
	  if(currentIndex >= filteredList.length) return;

	  const nextBatch = filteredList.slice(currentIndex, currentIndex + ITEMS_PER_LOAD);
	  nextBatch.forEach((a, index) => {
		const card = document.createElement('div');
		card.className = 'card';
		card.style.animationDelay = `${(currentIndex + index) * 0.08}s`;
		card.innerHTML = `
		  <img src="${a.img}" alt="${a.title}">
		  <div class="card-body">
			<div class="meta"><div class="genres">${a.genre.join(' • ')}</div><div class="rating">${a.rating.toFixed(1)}</div></div>
			<div class="title">${a.title}</div>
			<div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px;">
			  <div style="color:var(--muted); font-size:13px">${a.year}</div>
			  <div style="display:flex; gap:6px;">
				<button class="fav-btn" data-id="${a.id}">${a.fav?'★':'☆'}</button>
				<button class="btn" data-id="${a.id}">Voir</button>
			  </div>
			</div>
		  </div>`;
		grid.appendChild(card);
	  });

	  // Modale et favoris
	  grid.querySelectorAll('.btn').forEach(b => b.addEventListener('click', ()=>openModal(filteredList.find(a=>a.id==b.dataset.id))));
	  grid.querySelectorAll('.fav-btn').forEach(b => b.addEventListener('click', e=>{
		e.stopPropagation(); toggleFavorite(Number(b.dataset.id));
	  }));

	  currentIndex += ITEMS_PER_LOAD;

	  // Afficher message si plus de résultats
	  empty.style.display = currentIndex >= filteredList.length && filteredList.length === 0 ? 'block' : 'none';
	}
	function openModal(a){
	  modalRoot.innerHTML = `
		<div class="modal-backdrop" id="backdrop">
		  <div class="modal">
			<img src="${a.img}" alt="${a.title}">
			<div class="info">
			  <h2 style="margin:0 0 6px">${a.title}</h2>
			  <div style="color:var(--muted); margin-bottom:10px">${a.genre.join(' • ')} • ${a.year}</div>
			  <p style="margin:0 0 12px; line-height:1.5; color:#dbeafe;">${a.summary}</p>
			  <div style="display:flex; gap:8px; align-items:center">
				<div class="rating">${a.rating.toFixed(1)}</div>
				<button class="close" id="closeBtn">Fermer</button>
			  </div>
			</div>
		  </div>
		</div>`;
	  modalRoot.style.display='block';
	  document.getElementById('backdrop').addEventListener('click', closeModal);
	  document.getElementById('closeBtn').addEventListener('click', closeModal);
	  document.addEventListener('keydown', escHandler);
	}
	function closeModal(){ modalRoot.style.display='none'; modalRoot.innerHTML=''; document.removeEventListener('keydown', escHandler); }
	function escHandler(e){ if(e.key==='Escape') closeModal(); }

	function toggleFavorite(id){
	  const a = SAMPLE_ANIMES.find(a=>a.id===id);
	  a.fav = !a.fav;
	  // sauvegarder dans localStorage
	  const favs = SAMPLE_ANIMES.reduce((acc, a)=> { if(a.fav) acc[a.id]=true; return acc; }, {});
	  localStorage.setItem('animeFavs', JSON.stringify(favs));
	  applyFilters();
	}
	function applyFilters() {
	  const q = searchInput.value.toLowerCase();
	  const g = genreEl.value;
	  const s = sortEl.value;
	  const f = favFilterEl.value;

	  filteredList = SAMPLE_ANIMES.filter(a => a.title.toLowerCase().includes(q));
	  if(g !== 'Tout') filteredList = filteredList.filter(a => a.genre.includes(g));
	  if(f === 'fav') filteredList = filteredList.filter(a => a.fav);
	  if(s === 'top') filteredList.sort((a,b) => b.rating - a.rating);
	  if(s === 'new') filteredList.sort((a,b) => b.year - a.year);
	  if(s === 'az') filteredList.sort((a,b) => a.title.localeCompare(b.title));
	  if(s === 'za') filteredList.sort((a,b) => b.title.localeCompare(a.title));

	  // reset
	  currentIndex = 0;
	  grid.innerHTML = '';
	  renderNextBatch();
	}
	searchInput.addEventListener('input', applyFilters);
	genreEl.addEventListener('change', applyFilters);
	sortEl.addEventListener('change', applyFilters);
	favFilterEl.addEventListener('change', applyFilters);
	
	const backToTop = document.getElementById('backToTop');
	window.addEventListener('scroll', () => {
	  if (window.scrollY > 50) {
		backToTop.classList.add('show');
		backToTop.classList.remove('hide');
	  } else {
		backToTop.classList.add('hide');
		setTimeout(() => backToTop.classList.remove('show'), 200);
	  }
	});
	backToTop.addEventListener('click', () => {
	  window.scrollTo({ top: 0, behavior: 'smooth' });
	});
	window.AnimeHub = { SAMPLE_ANIMES, renderList, applyFilters };
	window.addEventListener('scroll', () => {
	  if(window.scrollY > 20){
		document.querySelector('header').classList.add('sticky');
	  } else {
		document.querySelector('header').classList.remove('sticky');
	  }

	  // Infinite scroll
	  if(window.innerHeight + window.scrollY >= document.body.offsetHeight - 200) {
		renderNextBatch();
	  }
	});
	applyFilters();
  </script>
  <script type="module">
	// Import the functions you need from the SDKs you need
	import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
	import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-analytics.js";
	// TODO: Add SDKs for Firebase products that you want to use
	// https://firebase.google.com/docs/web/setup#available-libraries

	// Your web app's Firebase configuration
	// For Firebase JS SDK v7.20.0 and later, measurementId is optional
	const firebaseConfig = {
	  apiKey: "AIzaSyCaJZi1Bn1vbeKOC5cM3Gi6nOFyWaH4NK4",
	  authDomain: "animehub-7.firebaseapp.com",
	  projectId: "animehub-7",
	  storageBucket: "animehub-7.firebasestorage.app",
	  messagingSenderId: "159114039206",
	  appId: "1:159114039206:web:0461d676e7ffff25c4c967",
	  measurementId: "G-6K4MB0XQEV"
	};

	// Initialize Firebase
	const app = initializeApp(firebaseConfig);
	const analytics = getAnalytics(app);
	  
	const emailInput = document.getElementById('email');
	const passwordInput = document.getElementById('password');
	const signupBtn = document.getElementById('signupBtn');
	const loginBtn = document.getElementById('loginBtn');
	const logoutBtn = document.getElementById('logoutBtn');
	import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
	const auth = getAuth(app);
	signupBtn.addEventListener('click', () => {
	  createUserWithEmailAndPassword(auth, emailInput.value, passwordInput.value)
		.then(userCredential => {
		  alert('Compte créé !');
		})
		.catch(err => alert(err.message));
	});

	loginBtn.addEventListener('click', () => {
	  signInWithEmailAndPassword(auth, emailInput.value, passwordInput.value)
		.then(async (userCredential) => {
		  alert('Connecté !');
		  logoutBtn.style.display = 'inline-block';
		  loginBtn.style.display = 'none';
		  signupBtn.style.display = 'none';

		  // Charger les favoris depuis Firestore
		  const uid = auth.currentUser.uid;
		  const userFavs = await loadFavorites(uid);
		  SAMPLE_ANIMES.forEach(a => a.fav = !!userFavs[a.id]);
		  applyFilters();
		})
		.catch(err => alert(err.message));
	});
	logoutBtn.addEventListener('click', () => {
	  signOut(auth).then(() => {
		alert('Déconnecté !');
		logoutBtn.style.display = 'none';
		loginBtn.style.display = 'inline-block';
		signupBtn.style.display = 'inline-block';

		// Réinitialiser tous les favoris à false
		SAMPLE_ANIMES.forEach(a => a.fav = false);
		localStorage.removeItem('animeFavs'); // si tu veux supprimer les favoris locaux
		applyFilters();
	  });
	});
	import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";

	const db = getFirestore(app);

	async function saveFavorites(uid, favs) {
	  await setDoc(doc(db, "favorites", uid), favs);
	}

	async function loadFavorites(uid) {
	  const docSnap = await getDoc(doc(db, "favorites", uid));
	  return docSnap.exists() ? docSnap.data() : {};
	}

	function toggleFavorite(id) {
	  const a = SAMPLE_ANIMES.find(a => a.id === id);
	  a.fav = !a.fav;
	  
	  if(auth.currentUser) {
		const uid = auth.currentUser.uid;
		const favs = SAMPLE_ANIMES.reduce((acc, a) => { if(a.fav) acc[a.id] = true; return acc; }, {});
		saveFavorites(uid, favs);
	  } else {
		// fallback localStorage
		const favs = SAMPLE_ANIMES.reduce((acc, a) => { if(a.fav) acc[a.id] = true; return acc; }, {});
		localStorage.setItem('animeFavs', JSON.stringify(favs));
	  }
	}
  </script>
</body>
</html>
