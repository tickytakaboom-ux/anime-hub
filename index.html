<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AnimeHub</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9ca3af; --accent:#06b6d4;
      --glass: rgba(255,255,255,0.04);
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:linear-gradient(180deg,#0b1220 0%, #061226 100%); color:#e6eef6; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
    .container{max-width:1100px; margin:32px auto; padding:20px;}
    header{display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:18px;}
    h1{font-size:28px; margin:0}
    p.lead{color:var(--muted); margin:6px 0 0; font-size:14px}
    .controls{display:flex; gap:10px; align-items:center;}
    input.search{padding:10px 12px 10px 36px; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:var(--glass); color:inherit; min-width:220px;}
    .select, .select-sm{padding:9px 10px; border-radius:8px; background:transparent; border:1px solid rgba(255,255,255,0.06); color:inherit;}
    .grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:16px; margin-top:18px;}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.06)); border-radius:12px; overflow:hidden; box-shadow: 0 6px 18px rgba(2,6,23,0.6); transition:transform .12s ease, box-shadow .12s ease;}
    .card:hover{transform:translateY(-6px); box-shadow:0 12px 30px rgba(2,6,23,0.8);}
    .card img{width:100%; height:300px; object-fit:cover; display:block; background:#111}
    .card-body{padding:12px;}
    .meta{display:flex; justify-content:space-between; align-items:center; gap:8px; color:var(--muted); font-size:13px}
    .title{font-weight:700; margin:8px 0 6px; font-size:16px}
    .genres{font-size:12px; color:var(--muted);}
    .btn{background:var(--accent); color:#052226; padding:8px 10px; border-radius:8px; border:none; cursor:pointer; font-weight:700;}
    .rating{background:rgba(0,0,0,0.45); padding:6px 8px; border-radius:8px; font-weight:700; font-size:13px;}
    .fav-btn{
      background:transparent;
      border:1px solid rgba(255,255,255,0.06);
      color:var(--accent);
      padding:6px 8px;
      border-radius:8px;
      cursor:pointer;
      font-weight:700;
      font-size:14px;
    }
	.select option, .select-sm option {color: #e6eef6;background-color: #0b1220
	}
	header {
	  display: flex;
	  align-items: center;
	  justify-content: space-between;
	  gap: 16px;
	  margin-bottom: 18px;
	  position: sticky; 
	  top: 0;             
	  z-index: 100;     
	  background: linear-gradient(180deg, rgba(11,18,32,0.95) 0%, rgba(6,18,38,0.95) 100%);
	  backdrop-filter: blur(6px); 
	  transition: box-shadow 0.2s ease, background 0.2s ease;
	  width: 100%;
	  padding: 20px 40px;
	  box-sizing: border-box;
	  flex-wrap: nowrap;
	}
	header.sticky {
	  box-shadow: 0 4px 20px rgba(0,0,0,0.6);
	}
    /* modal */
    .modal-backdrop{position:fixed; inset:0; background:linear-gradient(90deg, rgba(2,6,23,0.6), rgba(2,6,23,0.85)); display:flex; align-items:center; justify-content:center; z-index:80; padding:20px;}
    .modal{max-width:900px; width:100%; background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.06)); border-radius:12px; padding:18px; display:flex; gap:16px; color:inherit;}
    .modal img{width:220px; height:320px; object-fit:cover; border-radius:8px}
    .modal .info{flex:1}
    .close{background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted); padding:6px 8px; border-radius:8px; cursor:pointer;}
    footer{text-align:center; color:var(--muted); margin-top:24px; font-size:13px}
    /* small screens */
    @media (max-width:720px){
      header{flex-direction:column; align-items:flex-start}
      .controls{width:100%; margin-top:10px; flex-wrap:wrap}
      .card img{height:220px}
      .modal{flex-direction:column; align-items:center}
      .modal img{width:180px; height:260px}
    }
    /* search icon */
    .search-wrap{position:relative}
    .search-wrap svg{position:absolute; left:10px; top:50%; transform:translateY(-50%); opacity:0.8}
	#backToTop {
	  position: fixed;
	  bottom: 22px;
	  right: 22px;
	  padding: 10px 14px;
	  font-size: 16px;
	  border-radius: 10px;
	  background: var(--accent);
	  color: #052226;
	  border: none;
	  cursor: pointer;
	  font-weight: 700;
	  display: none;
	  box-shadow: 0 6px 20px rgba(0,0,0,0.4);
	  transition: opacity .2s ease, transform .2s ease;
	}
	#backToTop.show {
	  display: block;
	  opacity: 1;
	  transform: translateY(0);
	}
	#backToTop.hide {
	  opacity: 0;
	  transform: translateY(10px);
	}
	@keyframes fadeUp {
	  0% {
		opacity: 0;
		transform: translateY(20px);
	  }
	  100% {
		opacity: 1;
		transform: translateY(0);
	  }
	}

	.card {
	  animation: fadeUp 0.4s ease forwards;
	}
	#authContainer {
	  display: flex;
	  gap: 8px;
	  align-items: center;
	  background: rgba(255,255,255,0.05);
	  padding: 6px 12px;
	  border-radius: 12px;
	  backdrop-filter: blur(4px);
	  flex-wrap: wrap; 
	  flex-direction: row;
	  white-space: nowrap;
	  pointer-events: auto;
	}

	#authContainer input {
	  padding: 6px 10px;
	  border-radius: 8px;
	  border: 1px solid rgba(255,255,255,0.1);
	  background: rgba(0,0,0,0.2);
	  color: #e6eef6;
	  outline: none;
	  font-size: 14px;
	  height: 36px;
	}

	#authContainer button {
	  padding: 0px 12px;
	  border-radius: 8px;
	  border: none;
	  cursor: pointer;
	  background: var(--accent);
	  color: #052226;
	  font-weight: 700;
	  transition: 0.2s;
	  height: 36px;
	}

	#authContainer button:hover {
	  background: #0fc1e5;
	}
	@media (max-width:720px){
	  #authContainer {
		width: 100%;
		justify-content: flex-start;
	  }
	  #authContainer input {
		flex: 1;  /* prend toute la largeur dispo */
	  }
	  #authContainer button {
		flex-shrink: 0;
		padding: 6px 8px;
		font-size: 12px;
	  }
	}
	#userBox {
	  background: rgba(255,255,255,0.12);
	  padding: 6px 14px;
	  border-radius: 999px;
	  display: none;
	  align-items: center;
	  gap: 8px;
	  position: relative;
	  z-index: 999;
	  pointer-events: auto;
	  cursor: pointer;
	  text-decoration: none;
	  color: white;
	  font-weight: 700;
	}
	#userBox span {
	  color: white;
	}
	#authButtons {
	  display: flex;
	  flex-direction: column; 
	  gap: 6px;
	  width: 100%; /* pour que Ã§a rende propre mÃªme en rÃ©duit */
	}
	#authButtons button {
	  width: 100%;
	}
	.modal-auth {
	  position: fixed;
	  inset: 0;
	  background: rgba(0,0,0,0.65);
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  z-index: 200;
	  pointer-events: none;
	}

	.modal-auth-content {
	  background: var(--card);
	  padding: 20px;
	  border-radius: 12px;
	  width: 300px;
	  display: flex;
	  flex-direction: column;
	  gap: 12px;
	  animation: fadeUp .25s ease;
	}

	.modal-auth-content input {
	  padding: 10px;
	  border-radius: 8px;
	  border: 1px solid rgba(255,255,255,0.15);
	  background: var(--glass);
	  color: #fff;
	}

	.modal-auth-content button {
	  padding: 10px;
	  border-radius: 8px;
	  border: none;
	  cursor: pointer;
	  font-weight: 700;
	}

	.close-auth {
	  background: transparent;
	  border: 1px solid rgba(255,255,255,0.15);
	  color: var(--muted);
	}
	#logoutBtn {
	  padding: 4px 10px;
	  border: none;
	  border-radius: 4px;
	  cursor: pointer;
	}
	.modal-auth[style*="display: flex"] {
	  pointer-events: auto;
	}
	#userBox:hover {
	  background: rgba(255,255,255,0.2);
	}
  </style>
</head>
<body>
    <header>
      <div>
        <h1>AnimeHub</h1>
        <p class="lead">Ton univers anime Ã  portÃ©e de clic</p>
      </div>
      <div class="controls">
        <div class="search-wrap">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M21 21l-4.35-4.35" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="11" cy="11" r="6" stroke="#9ca3af" stroke-width="2"></circle></svg>
          <input id="search" class="search" placeholder="Rechercher un anime..." />
        </div>
        <select id="genre" class="select">
        </select>
        <select id="sort" class="select-sm">
          <option value="top">Top rating</option>
          <option value="new">Les plus rÃ©cents</option>
		  <option value="az">AlphabÃ©tique (A â†’ Z)</option>
		  <option value="za">AlphabÃ©tique (Z â†’ A)</option>
        </select>
        <select id="favFilter" class="select-sm">
          <option value="all">Tous</option>
          <option value="fav">Favoris seulement</option>
        </select>
      </div>
	  <div id="authContainer">
		<button id="openLogin">Connexion</button>
		<button id="openSignup">Inscription</button>

	  <a href="profile.html" id="userBox">
        <span id="username"></span>
      </a>

	  </div>
	  <div id="authModal" class="modal-auth" style="display:none;">
	    <div class="modal-auth-content">
		  <h2 id="authTitle">Connexion</h2>

		  <input type="email" id="authEmail" placeholder="Email">
		  <input type="password" id="authPassword" placeholder="Mot de passe">

		  <button id="authSubmit">Valider</button>
		  <button id="authClose" class="close-auth">Fermer</button>
	    </div>
	  </div>
    </header>
	<div class="container">
    <main>
      <div id="grid" class="grid"></div>
      <div id="empty" style="display:none; color:var(--muted); text-align:center; padding:40px 0;">Aucun rÃ©sultat...</div>
    </main>

    <footer>Il manque ton anime ? N'hÃ©site pas Ã  demander pour que je le rajoute.</footer>
  </div>

  <!-- Modal template -->
  <div id="modalRoot" style="display:none"></div>
  <button id="backToTop">â†‘ Top</button>
  <script>
    const SAMPLE_ANIMES = [
      { id:1, 
	  title:'One Piece', 
	  genre:['Adventure','Action'], 
	  rating:8.8, 
	  year:1999, 
	  img:'https://cdn.myanimelist.net/images/anime/1244/138851.jpg', 
	  summary:'One Piece suit Monkey D. Luffy, un ado qui veut devenir Roi des Pirates aprÃ¨s avoir mangÃ© un fruit magique qui rend son corps Ã©lastique. Il part sur les mers pour trouver le lÃ©gendaire trÃ©sor, le One Piece, et se crÃ©e petit Ã  petit un Ã©quipage aux pouvoirs et aux rÃªves diffÃ©rents, les Mugiwara. Ensemble, ils affrontent des pirates, des marines, des tyrans et des monstres, tout en vivant des aventures incroyables et en se rapprochant de la vÃ©ritÃ© sur le monde et sur le passÃ© cachÃ©.', 
	  fav:false },
      { id:2, 
	  title:'Solo Leveling', 
	  genre:['Action','Fantasy'], 
	  rating:8.2, 
	  year:2024, 
	  img:'https://cdn.myanimelist.net/images/anime/1448/147351.jpg', 
	  summary:'Dans un monde oÃ¹ des portails font apparaÃ®tre des monstres, les humains â€œchasseursâ€ risquent leur vie pour les affronter. Sung Jin-Woo, considÃ©rÃ© comme le chasseur le plus faible, survit par miracle Ã  un donjon terrifiant. AprÃ¨s Ã§a, il reÃ§oit un pouvoir unique : il peut devenir plus fort sans limite, comme dans un jeu vidÃ©o, en accomplissant des quÃªtes et en gagnant des niveaux. Ã€ partir de lÃ , Jin-Woo grimpe en puissance Ã  une vitesse folle, affronte des ennemis de plus en plus dangereux, et dÃ©couvre les secrets derriÃ¨re les portails et sa propre ascension.', 
	  fav:false },
      { id:3, 
	  title:'Death Note', 
	  genre:['Mystery','Thriller'], 
	  rating:9.3, 
	  year:2006, 
	  img:'https://cdn.myanimelist.net/images/anime/1079/138100.jpg', 
	  summary:'Death Note raconte lâ€™histoire de Light Yagami, un Ã©tudiant japonais brillant mais dÃ©sabusÃ©, qui trouve un carnet surnaturel appelÃ© Death Note. Ce carnet permet de tuer toute personne dont on Ã©crit le nom dedans. Convaincu quâ€™il peut crÃ©er un monde parfait en Ã©liminant les criminels, Light se transforme en justicier impitoyable sous le nom de Kira. Face Ã  lui, L, un dÃ©tective gÃ©nial et mystÃ©rieux, se lance dans une lutte intellectuelle intense pour lâ€™arrÃªter. Entre manipulations, trahisons et stratÃ©gies mentales, le combat entre Light et L devient une vÃ©ritable partie dâ€™Ã©checs mortelle.', 
	  fav:false },
      { id:4, 
	  title:'Jujutsu Kaisen', 
	  genre:['Action','Supernatural'], 
	  rating:8.6, 
	  year:2020, 
	  img:'https://cdn.myanimelist.net/images/anime/1180/153379.jpg', 
	  summary:'Lâ€™histoire suit Yuji Itadori, un lycÃ©en super sportif qui dÃ©couvre un monde cachÃ© rempli de malÃ©dictions, des esprits crÃ©Ã©s par les Ã©motions nÃ©gatives des humains. Quand il avale un doigt maudit contenant une puissante malÃ©diction, Ryomen Sukuna, il devient son hÃ´te. Yuji rejoint alors lâ€™Ã©cole de Jujutsu, oÃ¹ il apprend Ã  combattre les malÃ©dictions avec ses nouveaux pouvoirs, tout en essayant de protÃ©ger les innocents et de dÃ©couvrir comment vaincre Sukuna dÃ©finitivement.', 
	  fav:false },
      { id:5, 
	  title:'Oshi No Ko', 
	  genre:['Drama','Mystery'], 
	  rating:8.4, 
	  year:2023, 
	  img:'https://cdn.myanimelist.net/images/anime/1979/153329.jpg', 
	  summary:'Lâ€™histoire suit Aquamarine â€œAquaâ€ et Ruby, des jumeaux nÃ©s dans lâ€™industrie du divertissement aprÃ¨s une sÃ©rie dâ€™Ã©vÃ©nements tragiques liÃ©s Ã  leur mÃ¨re, une idole populaire. Le manga explore les coulisses sombres du showbiz, les ambitions, les manipulations et les secrets des cÃ©lÃ©britÃ©s, tout en suivant leur quÃªte de justice et de vÃ©ritÃ© sur le passÃ© de leur famille.', 
	  fav:false },
	  { id:6,
	  title:'Fairy Tail',
	  genre:['Action','Adventure','Fantasy'],
	  rating:7.1,
	  year:2009,
	  img:'https://cdn.myanimelist.net/images/anime/5/18179.jpg',
	  summary:`L'histoire suit Natsu Dragnir, un mage de feu, et ses amis de la guilde Fairy Tail, connus pour leur Ã©nergie, leur courage et leur sens de la camaraderie. Ensemble, ils accomplissent des missions, affrontent des ennemis redoutables et dÃ©couvrent des secrets sur le monde et sur eux-mÃªmes. Au fil des aventures, lâ€™anime met surtout lâ€™accent sur lâ€™amitiÃ©, la persÃ©vÃ©rance et la magie spectaculaire, avec des combats intenses et des moments Ã©mouvants qui renforcent les liens entre les personnages.`,
	  fav:false },
	  { id:7,
	  title:'Shangri-La Frontier',
	  genre:['Isekai','Fantasy','Game'],
	  rating:7.3,
	  year:2023,
	  img:'https://cdn.myanimelist.net/images/anime/1851/148885.jpg',
	  summary:`L'histoire suit Sunraku, un gamer hardcore qui adore les jeux vidÃ©o tout buggÃ©s. Un jour, il dÃ©cide de tester Shangri-La Frontier, un VRMMORPG extrÃªmement populaire et bien fait. GrÃ¢ce Ã  son expÃ©rience dans des jeux â€œhorriblesâ€, Sunraku devient incroyablement fort dans ce monde virtuel. Il se lance alors dans une aventure pleine de boss lÃ©gendaires, de dÃ©fis absurdes, de rencontres marquantes et de moments trÃ¨s drÃ´les, tout en essayant de percer les secrets du jeu.`,
	  fav:false },
	  { id:8,
	  title:'My Hero Academia',
	  genre:['Superheroes','Action'],
	  rating:8.0,
	  year:2016,
	  img:'https://cdn.myanimelist.net/images/anime/1959/151055.jpg',
	  summary:'Dans un monde oÃ¹ presque tout le monde possÃ¨de un pouvoir appelÃ© Alter, Izuku Midoriya naÃ®tâ€¦ sans aucun pouvoir. Son rÃªve pourtant : devenir un grand hÃ©ros comme son idole All Might. Sa vie bascule quand All Might lui transmet son Alter, One For All. Izuku intÃ¨gre alors lâ€™Ã©cole de hÃ©ros UA, oÃ¹ il sâ€™entraÃ®ne avec dâ€™autres Ã©lÃ¨ves pour devenir pro, affronte des vilains de plus en plus dangereux et dÃ©couvre les secrets derriÃ¨re son nouveau pouvoir.',
	  fav:false },
	  { id:9,
	  title:'Attack On Titan',
	  genre:['Dark','Fantasy','Action','Drama'],
	  rating:8.9,
	  year:2013,
	  img:'https://cdn.myanimelist.net/images/anime/1948/120625.jpg',
	  summary:'Lâ€™histoire suit Eren Yeager, qui vit dans une citÃ© entourÃ©e de gigantesques murs pour protÃ©ger lâ€™humanitÃ© des Titans, des crÃ©atures qui dÃ©vorent les humains. AprÃ¨s que sa ville est dÃ©truite et que sa mÃ¨re meurt, Eren jure dâ€™exterminer tous les Titans. Il rejoint alors lâ€™armÃ©e avec Mikasa et Armin, et dÃ©couvre peu Ã  peu la vÃ©ritÃ© : les Titans, les murs, le monde extÃ©rieurâ€¦ rien nâ€™est vraiment comme on le leur a racontÃ©. Lâ€™histoire devient une montÃ©e en tension entre guerre, secrets et survie, oÃ¹ chaque rÃ©vÃ©lation change totalement la vision du monde.',
	  fav:false },
	  { id:10,
	  title:'Classroom Of The Elite',
	  genre:['Psychological','School Life','Drama','Thriller'],
	  rating:7.9,
	  year:2017,
	  img:'https://cdn.myanimelist.net/images/anime/1176/153626.jpg',
	  summary:'Lâ€™histoire suit Kiyotaka AyanokÅji, un Ã©lÃ¨ve apparemment banal placÃ© dans la classe D, la classe la plus faible dâ€™un lycÃ©e dâ€™Ã©lite oÃ¹ tout fonctionne selon un systÃ¨me de points, de compÃ©tition et de manipulation. TrÃ¨s vite, on comprend quâ€™AyanokÅji cache un niveau dâ€™intelligence et de stratÃ©gie monstrueux, quâ€™il utilise discrÃ¨tement pour faire progresser sa classe, manipuler les autres groupes et naviguer dans un systÃ¨me scolaire impitoyable oÃ¹ chaque Ã©lÃ¨ve cherche Ã  grimper socialement. Lâ€™anime repose sur des jeux psychologiques, des alliances, des trahisons, et les secrets autour du passÃ© dâ€™AyanokÅji.',
	  fav:false },
	  { id:11,
	  title:'Rascal Does Not Dream Of ...',
	  genre:['Romance','Drama','Psychological','Slice Of Life','Supernatural'],
	  rating:7.9,
	  year:2018,
	  img:'https://cdn.myanimelist.net/images/anime/1823/149858.jpg',
	  summary:'Lâ€™histoire suit Sakuta Azusagawa, un lycÃ©en qui rencontre Mai Sakurajima, une actrice cÃ©lÃ¨bre devenue invisible aux yeux du monde Ã  cause dâ€™un phÃ©nomÃ¨ne liÃ© au â€œsyndrome de lâ€™adolescenceâ€. En cherchant Ã  lâ€™aider, Sakuta dÃ©couvre que dâ€™autres Ã©lÃ¨ves vivent aussi des phÃ©nomÃ¨nes surnaturels qui reflÃ¨tent leurs blessures Ã©motionnelles : harcÃ¨lement, pression, jalousie, identitÃ©â€¦ Ã€ chaque fois, il doit comprendre leur problÃ¨me pour les aider Ã  sâ€™en sortir, tout en dÃ©veloppant une relation touchante et sincÃ¨re avec Mai. Câ€™est un anime qui mÃ©lange romance, Ã©motions et un soupÃ§on de surnaturel de maniÃ¨re trÃ¨s chill.',
	  fav:false },
	  { id:12,
	  title:'Your Lie In April',
	  genre:['Drama','Romance','Musical'],
	  rating:9.2,
	  year:2014,
	  img:'https://cdn.myanimelist.net/images/anime/1405/143284.jpg',
	  summary:'Lâ€™histoire suit KÅsei Arima, un ancien prodige du piano qui a complÃ¨tement arrÃªtÃ© de jouer aprÃ¨s la mort de sa mÃ¨re. Il vit dans un monde â€œsans couleursâ€, incapable dâ€™entendre la musique correctement. Sa vie change le jour oÃ¹ il rencontre Kaori Miyazono, une violoniste pleine dâ€™Ã©nergie qui joue avec passion et libertÃ©. GrÃ¢ce Ã  elle, KÅsei se remet petit Ã  petit au piano, retrouve goÃ»t Ã  la musique et commence Ã  guÃ©rir de ses traumatismesâ€¦ mais Kaori cache un secret qui rend leur histoire encore plus bouleversante.',
	  fav:false },
	  { id:13,
	  title:'Kaguya-Sama : Love Is War',
	  genre:['Romance','Comedy','Psychological','School Life'],
	  rating:8.8,
	  year:2019,
	  img:'https://cdn.myanimelist.net/images/anime/1160/122627.jpg',
	  summary:'Lâ€™histoire suit Kaguya Shinomiya et Miyuki Shirogane, les deux cadors du conseil des Ã©lÃ¨ves, intelligents, respectÃ©sâ€¦ et secrÃ¨tement amoureux lâ€™un de lâ€™autre. Sauf quâ€™ils sont trop fiers pour avouer. Du coup, ils transforment chaque interaction en bataille mentale pour pousser lâ€™autre Ã  craquer en premier : manipulations, piÃ¨ges psychologiques, stratÃ©gies ridiculesâ€¦ tout y passe. Entre leurs plans qui tournent souvent au fiasco, lâ€™Ã©nergie chaotique de Chika, et les problÃ¨mes des autres membres du conseil, la â€œguerreâ€ devient une romcom hilarante oÃ¹ avouer ses sentiments est lâ€™objectif final.',
	  fav:false },
	  { id:14,
	  title:'Hunter X Hunter',
	  genre:['Adventure','Action','Fantasy','Psychological'],
	  rating:9.5,
	  year:2011,
	  img:'https://cdn.myanimelist.net/images/anime/1337/99013.jpg',
	  summary:'Lâ€™histoire suit Gon Freecss, un garÃ§on qui dÃ©couvre que son pÃ¨re, quâ€™il croyait mort, est en rÃ©alitÃ© un Hunter lÃ©gendaire. Gon dÃ©cide de devenir lui aussi Hunter pour le retrouver. En chemin, il se lie dâ€™amitiÃ© avec Killua, Leorio et Kurapika. Ensemble, ils passent des examens dangereux, affrontent des ennemis redoutables et explorent un monde rempli de crÃ©atures, secrets et pouvoirs surnaturels. Les combats reposent souvent sur stratÃ©gie et intelligence, pas juste sur la force brute.',
	  fav:false },
	  { id:15,
	  title:'Fruits Basket',
	  genre:['Romance','Drama','Slice Of Life'],
	  rating:8.5,
	  year:2019,
	  img:'https://cdn.myanimelist.net/images/anime/1085/114792.jpg',
	  summary:'Lâ€™histoire suit Tohru Honda, une lycÃ©enne orpheline qui finit par vivre avec la famille Soma, maudite par le zodiaque chinois : chaque membre se transforme en animal lorsquâ€™il est stressÃ© ou en contact avec quelquâ€™un du sexe opposÃ©. Au fil du temps, Tohru dÃ©couvre les secrets et blessures de chaque membre, les aide Ã  sâ€™accepter et guÃ©rir, et crÃ©e des liens forts dâ€™amitiÃ© et de famille. Lâ€™anime mÃ©lange humour, Ã©motions et moments touchants tout au long de lâ€™histoire.',
	  fav:false },
	  { id:16,
	  title:'Chainsaw Man',
	  genre:['Dark','Fantasy','Action','Horror'],
	  rating:8.0,
	  year:2022,
	  img:'https://cdn.myanimelist.net/images/anime/1806/126216.jpg',
	  summary:'Lâ€™histoire suit Denji, un jeune homme pauvre endettÃ©, qui chasse des dÃ©mons pour rembourser ses dettes. AprÃ¨s avoir Ã©tÃ© trahi et tuÃ©, il fusionne avec son chien-dÃ©mon Pochita et devient Chainsaw Man, capable de se transformer en humain avec des tronÃ§onneuses sortant de son corps. Il rejoint alors lâ€™Agence des Chasseurs de DÃ©mons et combat des crÃ©atures terrifiantes tout en dÃ©couvrant les vÃ©ritÃ©s sombres sur les dÃ©mons, les humains et ses propres dÃ©sirs. Lâ€™histoire mÃ©lange action sanglante, humour noir et drame Ã©motionnel.',
	  fav:false },
	  { id:17,
	  title:'Tokyo Revengers',
	  genre:['Action','Drama','Time Travel'],
	  rating:7.2,
	  year:2021,
	  img:'https://cdn.myanimelist.net/images/anime/1340/148694.jpg',
	  summary:'Lâ€™histoire suit Takemichi Hanagaki, un jeune homme ratÃ© qui apprend que son ex-petite amie de lycÃ©e, Hinata, a Ã©tÃ© tuÃ©e par un gang. Un jour, il revient mystÃ©rieusement 12 ans dans le passÃ© et dÃ©cide de changer le destin de Hinata en infiltrant et en remontant les rangs du gang Tokyo Manji. Au fil du temps, Takemichi se retrouve mÃªlÃ© Ã  des bagarres, trahisons et alliances, tout en essayant de changer lâ€™avenir et de protÃ©ger ses amis. Lâ€™anime mÃ©lange action, drame et voyages dans le temps, avec un fort cÃ´tÃ© Ã©motionnel.',
	  fav:false },
	  { id:18,
	  title:'Horimiya',
	  genre:['Romance','Slice Of Life','Comedy','School Life'],
	  rating:8.1,
	  year:2021,
	  img:'https://cdn.myanimelist.net/images/anime/1695/111486.jpg',
	  summary:'Lâ€™histoire suit Hori, une lycÃ©enne populaire et studieuse, et Miyamura, un camarade discret avec un cÃ´tÃ© rebelle cachÃ©. MalgrÃ© leurs apparences publiques opposÃ©es, ils dÃ©couvrent leur vrai visage lâ€™un pour lâ€™autre et deviennent amis puis amoureux. Lâ€™anime explore leur vie quotidienne au lycÃ©e, les relations avec leurs amis, et la faÃ§on dont chacun apprend Ã  sâ€™accepter et Ã  se confier. Câ€™est une romance douce, drÃ´le et touchante.',
	  fav:false },
	  { id:19,
	  title:'Blue Box',
	  genre:['Romance','Sports','Slice Of Life'],
	  rating:7.4,
	  year:2024,
	  img:'https://cdn.myanimelist.net/images/anime/1496/147108.jpg',
	  summary:'Lâ€™histoire suit Taiki Inomata, un lycÃ©en passionnÃ© de badminton, et Chika Aoshima, une star du basketball dans le mÃªme lycÃ©e. Ils se rapprochent peu Ã  peu malgrÃ© leur timiditÃ© et les rivalitÃ©s sportives, dÃ©couvrant des sentiments naissants lâ€™un pour lâ€™autre. Lâ€™anime mÃ©lange romance douce, compÃ©titions sportives et moments du quotidien, montrant comment leur passion pour le sport et leurs Ã©motions sâ€™entremÃªlent.',
	  fav:false },
	  { id:20,
	  title:'The Angel Next Door Spoils Me Rotten',
	  genre:['Romance','Slice Of Life','School Life'],
	  rating:7.3,
	  year:2023,
	  img:'https://cdn.myanimelist.net/images/anime/1746/152415.jpg',
	  summary:'Lâ€™histoire suit Mahiru Shiraishi, un lycÃ©en ordinaire, et Amane Fujimiya, sa voisine parfaite et attentionnÃ©e, surnommÃ©e â€œlâ€™angeâ€. Amane commence Ã  prendre soin de Mahiru, que ce soit pour les repas, les vÃªtements ou les petites attentions quotidiennes. Au fil du temps, leur proximitÃ© et leurs gestes tendres font naÃ®tre des sentiments, et ils apprennent Ã  sâ€™ouvrir lâ€™un Ã  lâ€™autre tout en partageant des moments simples et touchants du quotidien.',
	  fav:false },
	  { id:21,
	  title:'Alya Sometimes Hides Her Feelings In Russian',
	  genre:['Comedy','Romance','Slice Of Life','School Life'],
	  rating:6.8,
	  year:2024,
	  img:'https://cdn.myanimelist.net/images/anime/1277/153378.jpg',
	  summary:'Dans une acadÃ©mie japonaise, il y a Alisa Mikhailovna Kujou (surnommÃ©e â€œAlyaâ€), une demiâ€‘Russe demiâ€‘Japonaise : belle, brillante et froide â€” le genre â€œprincesse inaccessibleâ€. Elle sâ€™assoit Ã  cÃ´tÃ© dâ€™un Ã©lÃ¨ve un peu flemmard, Masachika Kuze, et malgrÃ© son attitude distante, Alya murmure parfois â€” en russe â€” des confidences et compliments adressÃ©s Ã  lui (pensant quâ€™il ne comprend pas). Masachika comprend parfaitement le russe, mais il fait semblant de ne rien piger. RÃ©sultat ? Une sÃ©rie de quiproquos, de regards gÃªnÃ©s, de malentendus et de sentiments qui grandissentâ€¦ tout en douceur.',
	  fav:false },
	  { id:22,
	  title:'My Teen Romantic Comedy SNAFU',
	  genre:['Romance','Comedy','School Life','Slice Of Life','Psychological'],
	  rating:8.3,
	  year:2013,
	  img:'https://cdn.myanimelist.net/images/anime/1958/107912.jpg',
	  summary:'Lâ€™histoire suit Hachiman Hikigaya, un lycÃ©en cynique et solitaire, qui croit que les relations humaines sont superficielles. Pour â€œapprendre la vieâ€, il est forcÃ© de rejoindre le Service Club, dirigÃ© par Yukino Yukinoshita, une fille brillante mais froide. Le club a pour mission dâ€™aider les Ã©lÃ¨ves avec leurs problÃ¨mes personnels. Ã€ travers des situations sociales, des quiproquos et des dÃ©bats philosophiques, Hachiman et Yukino (avec lâ€™aide de Yui Yuigahama) explorent les complexitÃ©s de lâ€™amitiÃ©, de lâ€™amour et des attentes sociales, souvent de maniÃ¨re rÃ©aliste et pleine de sarcasme.',
	  fav:false },
	  { id:23,
	  title:'My First Girlfriend is a Gal',
	  genre:['Ecchi','Romance','Comedy','School Life'],
	  rating:5.5,
	  year:2017,
	  img:'https://cdn.myanimelist.net/images/anime/9/86826.jpg',
	  summary:'Lâ€™histoire suit Junichi Hashiba, un lycÃ©en timide qui nâ€™a jamais eu de petite amie. AprÃ¨s avoir demandÃ© conseil Ã  ses amis, il finit par sortir avec Yui Kashii, une fille populaire et sexy, ce qui le plonge dans des situations gÃªnantes, embarrassantes et drÃ´les. Au fil du temps, Junichi dÃ©couvre que Yui nâ€™est pas juste une â€œgal superficielleâ€ : elle a ses propres sentiments et failles. Lâ€™anime mÃ©lange romance, humour et moments un peu coquins, tout en montrant la croissance du couple.',
	  fav:false },
	  { id:24,
	  title:'Maid Sama!',
	  genre:['Romance','Comedy','School Life'],
	  rating:7.8,
	  year:2010,
	  img:'https://cdn.myanimelist.net/images/anime/6/25254.jpg',
	  summary:'Lâ€™histoire suit Misaki Ayuzawa, prÃ©sidente du conseil des Ã©lÃ¨ves dâ€™un lycÃ©e auparavant rÃ©servÃ© aux garÃ§ons, connue pour sa rigueur et son sÃ©rieux. En secret, elle travaille dans un maid cafÃ© pour aider sa famille. Quand Takumi Usui, le garÃ§on le plus populaire du lycÃ©e, dÃ©couvre son secret, il commence Ã  la taquiner tout en la soutenant. Au fil du temps, leur relation Ã©volue entre humour, romance et moments touchants, montrant comment Misaki apprend Ã  faire confiance et Ã  sâ€™ouvrir aux autres.',
	  fav:false },
	  { id:25,
	  title:`Don't Toys With Me, Miss Nagatoro`,
	  genre:['Comedy','Romance','School Life','Slice Of Life'],
	  rating:6.8,
	  year:2021,
	  img:'https://cdn.myanimelist.net/images/anime/1902/129579.jpg',
	  summary:'Lâ€™histoire suit un lycÃ©en timide, souvent appelÃ© Senpai, qui se fait taquiner et provoquer sans arrÃªt par Nagatoro, une Ã©lÃ¨ve plus jeune et trÃ¨s espiÃ¨gle. Au fil des Ã©pisodes, leurs interactions passent du simple harcÃ¨lement lÃ©ger Ã  une relation plus profonde et complice, oÃ¹ Nagatoro montre quâ€™elle tient vraiment Ã  lui, et oÃ¹ Senpai gagne en confiance. Lâ€™anime mÃ©lange humour, romance et moments mignons du quotidien scolaire.',
	  fav:false },
	  { id:26,
	  title:'The Fragrant Flower Blooms with Dignity',
	  genre:['Romance','Drama','School Life','Slice Of Life'],
	  rating:7.9,
	  year:2025,
	  img:'https://cdn.myanimelist.net/images/anime/1744/150433.jpg',
	  summary:'Lâ€™histoire suit RintarÅ Tsumugi, un lycÃ©en qui a lâ€™air intimidant et rebelle â€” mais en rÃ©alitÃ©, câ€™est un mec gentil et doux. Il travaille dans la boulangerie familiale. Un jour, il croise Kaoruko Waguri, une Ã©lÃ¨ve dâ€™un lycÃ©e privÃ© prestigieux pour filles, trÃ¨s diffÃ©rent de son Ã©cole. Elle ne le juge pas sur son apparence, et pour la premiÃ¨re fois, RintarÅ sent quâ€™il pourrait exister quelquâ€™un qui le voit pour ce quâ€™il est vraiment. MalgrÃ© la rivalitÃ© entre leurs deux lycÃ©es, ils apprennent Ã  se connaÃ®tre, Ã  se rapprocher, Ã  dÃ©passer les prÃ©jugÃ©sâ€¦ et Ã  construire peu Ã  peu une relation sincÃ¨re, faite de douceur, de petits gestes et de soutien mutuel. Lâ€™anime met lâ€™accent sur les Ã©motions vraies, la timiditÃ©, les doutes, les diffÃ©rences sociales et la beautÃ© dâ€™une romance â€œnormaleâ€ mais touchante.',
	  fav:false },
	  { id:27,
	  title:'Cyberpunk : Edgerunners',
	  genre:['Action','Science Fiction','Cyberpunk','Drama'],
	  rating:8.7,
	  year:2022,
	  img:'https://cdn.myanimelist.net/images/anime/1818/126435.jpg',
	  summary:'Lâ€™histoire suit David Martinez, un adolescent des rues dans la ville dystopique de Night City, obsÃ©dÃ© par la technologie et les implants cybernÃ©tiques. AprÃ¨s un tragique incident, il dÃ©cide de rejoindre un groupe de mercenaires appelÃ©s les Edgerunners pour survivre et sâ€™Ã©lever dans ce monde cruel. Au fil de lâ€™histoire, David et son Ã©quipe affrontent des gangs, corporations et ennemis puissants, tout en explorant des thÃ¨mes de loyautÃ©, survie, ambition et humanitÃ© dans un univers violent et futuriste. Lâ€™anime combine action explosive, Ã©motion et tragÃ©die.',
	  fav:false },
	  { id:28,
	  title:'Romantic Killer',
	  genre:['Comedy','Romance','Slice Of Life','School Life','Supernatural'],
	  rating:6.7,
	  year:2022,
	  img:'https://cdn.myanimelist.net/images/anime/1764/142001.jpg',
	  summary:'Lâ€™hÃ©roÃ¯ne, Anzu Hoshino, est une lycÃ©enne qui adore les jeux vidÃ©o, le chocolat et son chat â€” mais nâ€™a absolument aucun intÃ©rÃªt pour lâ€™amour ou les garÃ§ons. Un jour, un sorcier bizarre nommÃ© Riri dÃ©barque de nulle part et dÃ©cide quâ€™Anzu doit vivre une â€œsimulation de dragueâ€ en plein lycÃ©e, entourÃ©e de plusieurs beaux garÃ§ons. Pour la forcer Ã  tomber amoureuse, il lui enlÃ¨ve ses trois passions : jeux vidÃ©o, chocolat et son chat. Anzu, qui ne veut surtout pas tomber dans un clichÃ© romantique, dÃ©cide alors de rÃ©sister de toutes ses forces. Mais plus lâ€™histoire avance, plus ses â€œquasiâ€‘rencontresâ€ la poussent Ã  reconsidÃ©rer ce quâ€™elle veut vraimentâ€¦ et la romance forcÃ©e risque bien de devenir quelque chose de plus vrai que prÃ©vu.',
	  fav:false },
	  { id:29,
	  title:'DanDaDan',
	  genre:['Action','Adventure','Supernatural','Horror','Comedy','Romance'],
	  rating:7.3,
	  year:2024,
	  img:'https://cdn.myanimelist.net/images/anime/1721/149001.jpg',
	  summary:'Lâ€™histoire commence avec deux lycÃ©ens : Momo Ayase, convaincue que les fantÃ´mes existent, et Ken Takakura (surnommÃ© â€œOkarunâ€), qui croit lui aux extraterrestres. Pour savoir lequel a raison, ils dÃ©cident de vÃ©rifier â€” Momo explore un lieu supposÃ© hantÃ©, Ken un spot dâ€™ovni. RÃ©sultat : ils ont tous les deux raisonâ€¦ FantÃ´mes et extraterrestres sont rÃ©els, et ce quâ€™ils dÃ©couvrent dÃ©passe lâ€™horreur et le WTF. Ã€ partir de lÃ  ils se retrouvent embarquÃ©s dans des aventures folles : exorcismes, batailles surnaturelles, crÃ©atures bizarres, complots occultes, alliÃ©s improbables â€” le tout dans un bordel cohÃ©rent, entre frissons, action et humour. En plus, entre deux monstres ou combats, y a des moments plus humains â€” doutes, amitiÃ©, rapprochements â€” ce qui donne un cÃ´tÃ© Ã©pique + sensible Ã  lâ€™histoire.',
	  fav:false },
	  { id:30,
	  title:'Wistoria : Wand And Sword',
	  genre:['Fantasy','Adventure','Action'],
	  rating:6.8,
	  year:2024,
	  img:'https://cdn.myanimelist.net/images/anime/1428/154046.jpg',
	  summary:'On suit Will Serfort, un Ã©tudiant dans une acadÃ©mie magique appelÃ©e Rigarden Magical Academy. Son rÃªve : devenir un des plus puissants magiciens, les â€œMagiaâ€¯Vanderâ€, pour tenir une promesse faite Ã  son amie dâ€™enfance. Le souci : Will nâ€™a aucun talent pour la magie â€” il ne peut lancer aucun sort. Du coup, il compense avec ses talents dâ€™Ã©pÃ©iste : il entre dans lâ€™acadÃ©mie et affronte des monstres dans des donjons avec son Ã©pÃ©e, espÃ©rant prouver sa valeur malgrÃ© son absence de magie. Au fil des Ã©pisodes/chapitres, on dÃ©couvre que le monde dans lequel il vit est riche : magie, factions, monstres, Ã©cole magique, et enjeux lourds. Will se fait des alliÃ©s mais aussi des rivaux, et montre que mÃªme sans magie, on peut se battre pour ses rÃªves â€” avec courage et dÃ©termination.',
	  fav:false },
	  { id:31,
	  title:'Demon Slayer',
	  genre:['Action','Dark','Fantasy','Adventure'],
	  rating:8.5,
	  year:2019,
	  img:'https://cdn.myanimelist.net/images/anime/1565/142711.jpg',
	  summary:'Lâ€™histoire suit Tanjiro Kamado, un jeune garÃ§on dont la famille a Ã©tÃ© massacrÃ©e par des dÃ©mons. Sa sÅ“ur Nezuko est la seule survivante, mais elle a Ã©tÃ© transformÃ©e en dÃ©mon. Tanjiro dÃ©cide de devenir un Demon Slayer pour venger sa famille et trouver un moyen de rendre sa sÅ“ur humaine. AccompagnÃ© de compagnons comme Zenitsu et Inosuke, il affronte des dÃ©mons puissants, dÃ©couvre les secrets de leur monde, et apprend ce que signifient courage, loyautÃ© et compassion.',
	  fav:false },
	  { id:32,
	  title:'My Dress-Up Darling',
	  genre:['Romance','Comedy','Slice Of Life','School Life'],
	  rating:8.4,
	  year:2022,
	  img:'https://cdn.myanimelist.net/images/anime/1024/150787.jpg',
	  summary:'Lâ€™histoire suit Wakana Gojo, un lycÃ©en passionnÃ© par la confection de poupÃ©es traditionnelles mais trÃ¨s timide, et Marin Kitagawa, une camarade de classe extravertie et fan de cosplay. Marin dÃ©couvre le talent de Wakana pour crÃ©er des costumes et lui demande de lâ€™aider Ã  rÃ©aliser ses cosplays de rÃªve. Au fil du temps, leur collaboration les rapproche, et ils dÃ©couvrent une relation douce, drÃ´le et complice, entre rires, moments gÃªnants et passions partagÃ©es.',
	  fav:false },
	  { id:33,
	  title:'Bleach',
	  genre:['Action','Adventure','Supernatural'],
	  rating:8.7,
	  year:2004,
	  img:'https://cdn.myanimelist.net/images/anime/1488/150890.jpg',
	  summary:'Lâ€™histoire suit Ichigo Kurosaki, un lycÃ©en capable de voir les fantÃ´mes. Sa vie change lorsquâ€™il rencontre Rukia Kuchiki, une shinigami (faucheuse dâ€™Ã¢mes), qui lui transfÃ¨re ses pouvoirs pour quâ€™il protÃ¨ge sa famille et les vivants des Hollows, des esprits malÃ©fiques. Ichigo devient alors un shinigami temporaire, combattant des ennemis puissants et dÃ©couvrant un monde spirituel complexe, tout en protÃ©geant ses amis et en affrontant des dilemmes moraux. Lâ€™anime mÃ©lange action, aventures, drame et liens dâ€™amitiÃ©.',
	  fav:false },
	  { id:34,
	  title:'Sakamoto Days',
	  genre:['Action','Comedy','Slice Of Life'],
	  rating:7.4,
	  year:2025,
	  img:'https://cdn.myanimelist.net/images/anime/1758/148719.jpg',
	  summary:'Le perso principal, Taro Sakamoto, câ€™Ã©tait un tueur Ã  gages lÃ©gendaire, craint et respectÃ© dans le milieu. Mais un jour il tombe amoureux, dÃ©cide dâ€™abandonner la vie dâ€™assassin, se marie, a une fille, et ouvre une petite supÃ©rette pour mener une vie tranquille. Il est devenu un mari/papa un peu rondouillard â€” mais toujours costaud dans lâ€™Ã¢me. Sauf que son passÃ© le rattrape : dâ€™anciens ennemis, des chasseurs de primes, des assassins reviennent pour lui. Pour protÃ©ger sa famille, Sakamoto doit reprendre du service â€” mais tout en essayant de garder sa promesse (ne plus tuer) et sa nouvelle vie paisible.',
	  fav:false },
	  { id:35,
	  title:'Dragon Ball',
	  genre:['Action','Adventure','Fantasy'],
	  rating:7.6,
	  year:1986,
	  img:'https://cdn.myanimelist.net/images/anime/1723/145231.jpg',
	  summary:'Lâ€™histoire suit Goku, un jeune garÃ§on dotÃ© dâ€™une force surhumaine et dâ€™une queue de singe. Il part Ã  lâ€™aventure pour retrouver les Dragon Balls, sept boules magiques qui, une fois rÃ©unies, permettent de faire apparaÃ®tre le dragon Shenron et dâ€™exaucer un vÅ“u. Au fil de ses voyages, Goku rencontre des amis comme Bulma, Krillin et Yamcha, affronte des ennemis redoutables, participe Ã  des tournois dâ€™arts martiaux, et dÃ©couvre peu Ã  peu ses origines extraterrestres et ses incroyables pouvoirs. Lâ€™anime mÃ©lange action, humour, aventures et leÃ§ons sur lâ€™amitiÃ© et le courage.',
	  fav:false }
	];
	

	const genreEl = document.getElementById('genre');
	const sortEl = document.getElementById('sort');
	const favFilterEl = document.getElementById('favFilter');
	const grid = document.getElementById('grid');
	const searchInput = document.getElementById('search');
	const empty = document.getElementById('empty');
	const modalRoot = document.getElementById('modalRoot');

	// Remplir select genres
	const genres = new Set(['Tout']);
	SAMPLE_ANIMES.forEach(a => a.genre.forEach(g => genres.add(g)));
	genres.forEach(g => { const o = document.createElement('option'); o.textContent=o.value=g; genreEl.appendChild(o); });
	
	const ITEMS_PER_LOAD = 6; // combien de cartes Ã  charger Ã  chaque fois
	let currentIndex = 0; // index de dÃ©part pour le rendu
	let filteredList = []; // liste filtrÃ©e aprÃ¨s recherche/tri


	function renderList(list){
	  grid.innerHTML = '';
	  if(!list.length){ empty.style.display='block'; return; }
	  empty.style.display='none';

	  list.forEach((a, index) => {
		  const card = document.createElement('div'); 
		  card.className = 'card';
		  card.style.animationDelay = `${index * 0.08}s`; // 0.08s entre chaque carte
		  card.innerHTML = `
			<img src="${a.img}" alt="${a.title}">
			<div class="card-body">
			  <div class="meta"><div class="genres">${a.genre.join(' â€¢ ')}</div><div class="rating">${a.rating.toFixed(1)}</div></div>
			  <div class="title">${a.title}</div>
			  <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px;">
				<div style="color:var(--muted); font-size:13px">${a.year}</div>
				<div style="display:flex; gap:6px;">
				  <button class="fav-btn" data-id="${a.id}">${a.fav?'â˜…':'â˜†'}</button>
				  <button class="btn" data-id="${a.id}">Voir</button>
				</div>
			  </div>
			</div>`;
		  grid.appendChild(card);
		});
	  // Modale et favoris
	  grid.querySelectorAll('.btn').forEach(b => b.addEventListener('click', ()=>openModal(SAMPLE_ANIMES.find(a=>a.id==b.dataset.id))));
	  grid.querySelectorAll('.fav-btn').forEach(b => b.addEventListener('click', e=>{
		e.stopPropagation(); toggleFavorite(Number(b.dataset.id));
	  }));
	}
	function renderNextBatch() {
	  const grid = document.getElementById('grid');
	  if(currentIndex >= filteredList.length) return;

	  const nextBatch = filteredList.slice(currentIndex, currentIndex + ITEMS_PER_LOAD);
	  nextBatch.forEach((a, index) => {
		const card = document.createElement('div');
		card.className = 'card';
		card.style.animationDelay = `${(currentIndex + index) * 0.08}s`;
		card.innerHTML = `
		  <img src="${a.img}" alt="${a.title}">
		  <div class="card-body">
			<div class="meta"><div class="genres">${a.genre.join(' â€¢ ')}</div><div class="rating">${a.rating.toFixed(1)}</div></div>
			<div class="title">${a.title}</div>
			<div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px;">
			  <div style="color:var(--muted); font-size:13px">${a.year}</div>
			  <div style="display:flex; gap:6px;">
				<button class="fav-btn" data-id="${a.id}">${a.fav?'â˜…':'â˜†'}</button>
				<button class="btn" data-id="${a.id}">Voir</button>
			  </div>
			</div>
		  </div>`;
		grid.appendChild(card);
	  });

	  currentIndex += ITEMS_PER_LOAD;

	  // Afficher message si plus de rÃ©sultats
	  empty.style.display = currentIndex >= filteredList.length && filteredList.length === 0 ? 'block' : 'none';
	}
	function openModal(a){
	  modalRoot.innerHTML = `
		<div class="modal-backdrop" id="backdrop">
		  <div class="modal">
			<img src="${a.img}" alt="${a.title}">
			<div class="info">
			  <h2 style="margin:0 0 6px">${a.title}</h2>
			  <div style="color:var(--muted); margin-bottom:10px">${a.genre.join(' â€¢ ')} â€¢ ${a.year}</div>
			  <p style="margin:0 0 12px; line-height:1.5; color:#dbeafe;">${a.summary}</p>
			  <div style="display:flex; gap:8px; align-items:center">
				<div class="rating">${a.rating.toFixed(1)}</div>
				<button class="close" id="closeBtn">Fermer</button>
			  </div>
			</div>
		  </div>
		</div>`;
	  modalRoot.style.display='block';
	  document.getElementById('backdrop').addEventListener('click', closeModal);
	  document.getElementById('closeBtn').addEventListener('click', closeModal);
	  document.addEventListener('keydown', escHandler);
	}
	function closeModal(){ modalRoot.style.display='none'; modalRoot.innerHTML=''; document.removeEventListener('keydown', escHandler); }
	function escHandler(e){ if(e.key==='Escape') closeModal(); }
    
	function applyFilters() {
	  const q = searchInput.value.toLowerCase();
	  const g = genreEl.value;
	  const s = sortEl.value;
	  const f = favFilterEl.value;

	  filteredList = SAMPLE_ANIMES.filter(a => a.title.toLowerCase().includes(q));
	  if(g !== 'Tout') filteredList = filteredList.filter(a => a.genre.includes(g));
	  if(f === 'fav') filteredList = filteredList.filter(a => a.fav);
	  if(s === 'top') filteredList.sort((a,b) => b.rating - a.rating);
	  if(s === 'new') filteredList.sort((a,b) => b.year - a.year);
	  if(s === 'az') filteredList.sort((a,b) => a.title.localeCompare(b.title));
	  if(s === 'za') filteredList.sort((a,b) => b.title.localeCompare(a.title));

	  // reset
	  currentIndex = 0;
	  grid.innerHTML = '';
	  renderNextBatch();
	}
	searchInput.addEventListener('input', applyFilters);
	genreEl.addEventListener('change', applyFilters);
	sortEl.addEventListener('change', applyFilters);
	favFilterEl.addEventListener('change', applyFilters);
	
	const backToTop = document.getElementById('backToTop');
	window.addEventListener('scroll', () => {
	  if (window.scrollY > 50) {
		backToTop.classList.add('show');
		backToTop.classList.remove('hide');
	  } else {
		backToTop.classList.add('hide');
		setTimeout(() => backToTop.classList.remove('show'), 200);
	  }
	});
	backToTop.addEventListener('click', () => {
	  window.scrollTo({ top: 0, behavior: 'smooth' });
	});
	window.AnimeHub = { SAMPLE_ANIMES, renderList, applyFilters };
	window.addEventListener('scroll', () => {
	  if(window.scrollY > 20){
		document.querySelector('header').classList.add('sticky');
	  } else {
		document.querySelector('header').classList.remove('sticky');
	  }

	  // Infinite scroll
	  if(window.innerHeight + window.scrollY >= document.body.offsetHeight - 200) {
		renderNextBatch();
	  }
	});
	const authModal = document.getElementById("authModal");
	const authTitle = document.getElementById("authTitle");
	const authSubmit = document.getElementById("authSubmit");
	const authEmail = document.getElementById("authEmail");
	const authPassword = document.getElementById("authPassword");

	document.getElementById("openLogin").onclick = () => {
	  authTitle.textContent = "Connexion";
	  authSubmit.dataset.mode = "login";
	  authModal.style.display = "flex";
	};

	document.getElementById("openSignup").onclick = () => {
	  authTitle.textContent = "Inscription";
	  authSubmit.dataset.mode = "signup";
	  authModal.style.display = "flex";
	};

	document.getElementById("authClose").onclick = () => {
	  authModal.style.display = "none";
	};
	applyFilters();
  </script>
  <script type="module">
      import { 
          initializeApp 
      } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
      import { 
          getAuth, onAuthStateChanged, signOut 
      } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
	  import { getFirestore, doc, getDoc, setDoc, updateDoc, arrayUnion, arrayRemove, increment } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";
	  
      const firebaseConfig = {
          apiKey: "AIzaSyCaJZi1Bn1vbeKOC5cM3Gi6nOFyWaH4NK4",
          authDomain: "animehub-7.firebaseapp.com",
          projectId: "animehub-7",
          storageBucket: "animehub-7.firebasestorage.app",
          messagingSenderId: "159114039206",
          appId: "1:159114039206:web:0461d676e7ffff25c4c967",
          measurementId: "G-6K4MB0XQEV"
      };

      const app = initializeApp(firebaseConfig);
      const userBox = document.getElementById("userBox");
      const username = document.getElementById("username");

      const openLogin = document.getElementById("openLogin");
      const openSignup = document.getElementById("openSignup");
	  const db = getFirestore(app);
	  const auth = getAuth(app);

	  userBox.addEventListener("click", () => {
        window.location.href = "profile.html";
      });

	  onAuthStateChanged(auth, async (user) => {
	    if (user) {
		  if (openLogin) openLogin.style.display = "none";
		  if (openSignup) openSignup.style.display = "none";
		  userBox.style.display = "flex";
		  await loadFavorites();
		  applyFilters();

		  try {
		    const userDocRef = doc(db, "users", user.uid);
		    const userSnap = await getDoc(userDocRef);

		    if (userSnap.exists()) {
		      const data = userSnap.data();
			  username.textContent = data.username || user.email.split("@")[0];
		    } else {
			  // CrÃ©e le doc Firestore si inexistant (utile pour comptes crÃ©Ã©s avant Firestore)
			  const userData = {
			    username: user.email.split("@")[0],
			    email: user.email,
			    favorites: [],
			    ratings: {}
			  };
			  await setDoc(userDocRef, userData);
			  username.textContent = userData.username;
		    }

		  } catch (err) {
		    console.error("Erreur rÃ©cupÃ©ration Firestore:", err);
		    username.textContent = user.email.split("@")[0]; // fallback
		  }

	    } else {
		  if (openLogin) openLogin.style.display = "inline-block";
		  if (openSignup) openSignup.style.display = "inline-block";
		  userBox.style.display = "none";
		  window.location.href = "auth.html";
	    }
	  });
	  async function toggleFavorite(animeId) {
	    const user = auth.currentUser;
	    if (!user) {
		  alert("Connecte-toi pour ajouter un favori !");
		  return;
	   }

	    const anime = SAMPLE_ANIMES.find(a => a.id === animeId);
	    if (!anime) return;

	    const userRef = doc(db, "users", user.uid);
	    const animeRef = doc(db, "animes", String(animeId));

	    const wasFav = anime.fav;
	    anime.fav = !wasFav;

	    try {
		  // ðŸ”¹ S'assurer que le doc anime existe
		  const snap = await getDoc(animeRef);
		  if (!snap.exists()) {
		    await setDoc(animeRef, { likes: 0 }, { merge: true });
		  }

		  // ðŸ”¹ Mettre Ã  jour les favoris de l'utilisateur
		  if (!wasFav) {
		    await updateDoc(userRef, { favorites: arrayUnion(animeId) });
		    await updateDoc(animeRef, { likes: increment(1) });
		  } else {
		    await updateDoc(userRef, { favorites: arrayRemove(animeId) });
		    await updateDoc(animeRef, { likes: increment(-1) });
		  }
	    } catch (err) {
		  console.error("Erreur toggleFavorite:", err);
	    }

	    // ðŸ”¹ Mettre Ã  jour l'UI
	    const btn = document.querySelector(`.fav-btn[data-id="${animeId}"]`);
	    if (btn) btn.textContent = anime.fav ? "â˜…" : "â˜†";

	    applyFilters(); // refresh UI
	  }

	  // Modale
	  grid.addEventListener('click', e => {
	    if (e.target.classList.contains('btn')) {
		  const id = Number(e.target.dataset.id);
		  const anime = filteredList.find(a => a.id === id);
		  if (anime) openModal(anime);
	    }
	  });

	  // Favoris
	  grid.addEventListener('click', e => {
	   if (e.target.classList.contains('fav-btn')) {
		  e.stopPropagation();
		  const id = Number(e.target.dataset.id);
		  toggleFavorite(id);
	    }
	  });
	  async function loadFavorites() {
	    const user = auth.currentUser;
	    if (!user) return;

	    const userRef = doc(db, "users", user.uid);
	    const snap = await getDoc(userRef);

	    if (!snap.exists()) return;

	    const data = snap.data();
	    if (!Array.isArray(data.favorites)) return;

	    // ðŸ”¥ Synchronisation Firestore â†’ UI
	    SAMPLE_ANIMES.forEach(anime => {
		  anime.fav = data.favorites.includes(anime.id);
	    });
	  }

	  function updateFavoriteButtons() {
	    grid.querySelectorAll('.fav-btn').forEach(b => {
		  const id = Number(b.dataset.id);
		  const anime = filteredList.find(a => a.id === id);
		  if (anime && anime.isFavorite) {
		    b.classList.add('favorited'); // ou ton style CSS
		  } else {
		    b.classList.remove('favorited');
		  }
		})
	  };	
  </script>
</body>
</html>
