<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AnimeHub</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9ca3af; --accent:#06b6d4;
      --glass: rgba(255,255,255,0.04);
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:linear-gradient(180deg,#0b1220 0%, #061226 100%); color:#e6eef6; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
    .container{max-width:1100px; margin:32px auto; padding:20px;}
    header{display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:18px;}
    h1{font-size:28px; margin:0}
    p.lead{color:var(--muted); margin:6px 0 0; font-size:14px}
    .controls{display:flex; gap:10px; align-items:center;}
    input.search{padding:10px 12px 10px 36px; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:var(--glass); color:inherit; min-width:220px;}
    .select, .select-sm{padding:9px 10px; border-radius:8px; background:transparent; border:1px solid rgba(255,255,255,0.06); color:inherit;}
    .grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:16px; margin-top:18px;}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.06)); border-radius:12px; overflow:hidden; box-shadow: 0 6px 18px rgba(2,6,23,0.6); transition:transform .12s ease, box-shadow .12s ease;}
    .card:hover{transform:translateY(-6px); box-shadow:0 12px 30px rgba(2,6,23,0.8);}
    .card img{width:100%; height:300px; object-fit:cover; display:block; background:#111}
    .card-body{padding:12px;}
    .meta{display:flex; justify-content:space-between; align-items:center; gap:8px; color:var(--muted); font-size:13px}
    .title{font-weight:700; margin:8px 0 6px; font-size:16px}
    .genres{font-size:12px; color:var(--muted);}
    .btn {
	  background: linear-gradient(135deg, var(--accent), #0fc1e5);
	  color: #052226;
	  padding: 8px 14px;
	  border-radius: 10px;
	  border: none;
	  cursor: pointer;
	  font-weight: 700;
	  font-size: 13px;
	  letter-spacing: 0.3px;
	  box-shadow: 0 4px 14px rgba(6,182,212,0.35);
	  transition: transform 0.15s ease, box-shadow 0.15s ease, filter 0.15s ease;
	}
	.btn:hover {
	  transform: translateY(-2px);
	  box-shadow: 0 8px 22px rgba(6,182,212,0.55);
	  filter: brightness(1.05);
	}
	.btn:active {
	  transform: translateY(0);
	  box-shadow: 0 4px 12px rgba(6,182,212,0.35);
	}
    .rating{background:rgba(0,0,0,0.45); padding:6px 8px; border-radius:8px; font-weight:700; font-size:13px;}
    .fav-btn{
      background:transparent;
      border:1px solid rgba(255,255,255,0.06);
      color:var(--accent);
      padding:6px 8px;
      border-radius:8px;
      cursor:pointer;
      font-weight:700;
      font-size:14px;
    }
	.select option, .select-sm option {color: #e6eef6;background-color: #0b1220
	}
	header {
	  display: flex;
	  align-items: center;
	  justify-content: space-between;
	  gap: 16px;
	  margin-bottom: 18px;
	  position: sticky; 
	  top: 0;             
	  z-index: 100;     
	  background: linear-gradient(180deg, rgba(11,18,32,0.95) 0%, rgba(6,18,38,0.95) 100%);
	  backdrop-filter: blur(6px); 
	  transition: box-shadow 0.2s ease, background 0.2s ease;
	  width: 100%;
	  padding: 20px 40px;
	  box-sizing: border-box;
	  flex-wrap: nowrap;
	}
	header.sticky {
	  box-shadow: 0 4px 20px rgba(0,0,0,0.6);
	}
    /* modal */
    .modal-backdrop{position:fixed; inset:0; background:linear-gradient(90deg, rgba(2,6,23,0.6), rgba(2,6,23,0.85)); display:flex; align-items:center; justify-content:center; z-index:80; padding:20px;}
    .modal{max-width:900px; width:100%; background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.06)); border-radius:12px; padding:18px; display:flex; gap:16px; color:inherit;}
    .modal img{width:220px; height:320px; object-fit:cover; border-radius:8px}
    .modal .info{flex:1}
    .close{background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted); padding:6px 8px; border-radius:8px; cursor:pointer;}
    footer{text-align:center; color:var(--muted); margin-top:24px; font-size:13px}
    /* small screens */
    @media (max-width:720px){
      header{flex-direction:column; align-items:flex-start}
      .controls{width:100%; margin-top:10px; flex-wrap:wrap}
      .card img{height:220px}
      .modal{flex-direction:column; align-items:center}
      .modal img{width:180px; height:260px}
    }
    /* search icon */
    .search-wrap{position:relative}
    .search-wrap svg{position:absolute; left:10px; top:50%; transform:translateY(-50%); opacity:0.8}
	#backToTop {
	  position: fixed;
	  bottom: 22px;
	  right: 22px;
	  padding: 10px 14px;
	  font-size: 16px;
	  border-radius: 10px;
	  background: var(--accent);
	  color: #052226;
	  border: none;
	  cursor: pointer;
	  font-weight: 700;
	  display: none;
	  box-shadow: 0 6px 20px rgba(0,0,0,0.4);
	  transition: opacity .2s ease, transform .2s ease;
	}
	#backToTop.show {
	  display: block;
	  opacity: 1;
	  transform: translateY(0);
	}
	#backToTop.hide {
	  opacity: 0;
	  transform: translateY(10px);
	}
	@keyframes fadeUp {
	  0% {
		opacity: 0;
		transform: translateY(20px);
	  }
	  100% {
		opacity: 1;
		transform: translateY(0);
	  }
	}

	.card {
	  animation: fadeUp 0.4s ease forwards;
	}
	#authContainer {
	  display: flex;
	  gap: 8px;
	  align-items: center;
	  background: rgba(255,255,255,0.05);
	  padding: 6px 12px;
	  border-radius: 12px;
	  backdrop-filter: blur(4px);
	  flex-wrap: wrap; 
	  flex-direction: row;
	  white-space: nowrap;
	  pointer-events: auto;
	}

	#authContainer input {
	  padding: 6px 10px;
	  border-radius: 8px;
	  border: 1px solid rgba(255,255,255,0.1);
	  background: rgba(0,0,0,0.2);
	  color: #e6eef6;
	  outline: none;
	  font-size: 14px;
	  height: 36px;
	}

	#authContainer button {
	  padding: 0px 12px;
	  border-radius: 8px;
	  border: none;
	  cursor: pointer;
	  background: var(--accent);
	  color: #052226;
	  font-weight: 700;
	  transition: 0.2s;
	  height: 36px;
	}

	#authContainer button:hover {
	  background: #0fc1e5;
	}
	@media (max-width:720px){
	  #authContainer {
		width: 100%;
		justify-content: flex-start;
	  }
	  #authContainer input {
		flex: 1;  /* prend toute la largeur dispo */
	  }
	  #authContainer button {
		flex-shrink: 0;
		padding: 6px 8px;
		font-size: 12px;
	  }
	}
	#userBox {
	  background: rgba(255,255,255,0.12);
	  padding: 6px 14px;
	  border-radius: 999px;
	  display: none;
	  align-items: center;
	  gap: 8px;
	  position: relative;
	  z-index: 999;
	  pointer-events: auto;
	  cursor: pointer;
	  text-decoration: none;
	  color: white;
	  font-weight: 700;
	}
	#userBox span {
	  color: white;
	}
	#authButtons {
	  display: flex;
	  flex-direction: column; 
	  gap: 6px;
	  width: 100%; /* pour que √ßa rende propre m√™me en r√©duit */
	}
	#authButtons button {
	  width: 100%;
	}
	.modal-auth {
	  position: fixed;
	  inset: 0;
	  background: rgba(0,0,0,0.65);
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  z-index: 200;
	  pointer-events: none;
	}

	.modal-auth-content {
	  background: var(--card);
	  padding: 20px;
	  border-radius: 12px;
	  width: 300px;
	  display: flex;
	  flex-direction: column;
	  gap: 12px;
	  animation: fadeUp .25s ease;
	}

	.modal-auth-content input {
	  padding: 10px;
	  border-radius: 8px;
	  border: 1px solid rgba(255,255,255,0.15);
	  background: var(--glass);
	  color: #fff;
	}

	.modal-auth-content button {
	  padding: 10px;
	  border-radius: 8px;
	  border: none;
	  cursor: pointer;
	  font-weight: 700;
	}

	.close-auth {
	  background: transparent;
	  border: 1px solid rgba(255,255,255,0.15);
	  color: var(--muted);
	}
	#logoutBtn {
	  padding: 4px 10px;
	  border: none;
	  border-radius: 4px;
	  cursor: pointer;
	}
	.modal-auth[style*="display: flex"] {
	  pointer-events: auto;
	}
	#userBox:hover {
	  background: rgba(255,255,255,0.2);
	}
	.badge-trending {
	  position: absolute;
	  top: 8px;
	  left: 8px;
	  background: #ff4500;
	  color: white;
	  font-size: 12px;
	  padding: 4px 6px;
	  border-radius: 6px;
	  font-weight: bold;
	}
	.rate-select {
	  background: #0f172a;
	  color: white;
	  border: 1px solid rgba(255,255,255,0.2);
	  border-radius: 8px;
	  padding: 6px;
	  font-size: 13px;
	}
	.notif-container {
	  position: relative;
	  cursor: pointer;
	  margin-right: 10px;
	}

	.notif-badge {
	  position: absolute;
	  top: -5px;
	  right: -5px;
	  background-color: red;
	  color: white;
	  font-size: 12px;
	  font-weight: bold;
	  padding: 2px 6px;
	  border-radius: 50%;
	  display: none; /* cach√© si 0 notif */
	}

	#notifBell {
	  font-size: 24px;
	  color: #fff;
	}
	@keyframes bounce {
	  0%, 100% { transform: translateY(0); }
	  50% { transform: translateY(-5px); }
	}

	.notif-badge.show {
	  display: inline-block;
	  animation: bounce 0.5s ease;
	}
	.notif-dropdown {
	  position: absolute;
	  top: 28px; /* juste en dessous de la cloche */
	  right: 0;
	  background: var(--card);
	  border-radius: 12px;
	  box-shadow: 0 6px 20px rgba(0,0,0,0.4);
	  width: 280px;
	  max-height: 400px;
	  overflow-y: auto;
	  z-index: 500;
	  padding: 10px 0;
	}

	.notif-dropdown li {
	  padding: 10px 16px;
	  font-size: 14px;
	  color: #e6eef6;
	  border-bottom: 1px solid rgba(255,255,255,0.08);
	  cursor: pointer;
	}

	.notif-dropdown li:hover {
	  background: rgba(255,255,255,0.05);
	}
  </style>
  <!-- Favicon classique -->
  <link rel="icon" type="image/png" href="icon_animehub.png">
  <!-- Ic√¥ne Apple touch (pour iPhone/iPad) -->
  <link rel="apple-touch-icon" sizes="180x180" href="icon_animehub.png">
  <link rel="apple-touch-icon" sizes="152x152" href="icon_animehub.png">
  <link rel="apple-touch-icon" sizes="120x120" href="icon_animehub.png">
  <link rel="apple-touch-icon" sizes="76x76" href="icon_animehub.png">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
</head>
<body>
    <header>
      <div>
        <h1>AnimeHub</h1>
        <p class="lead">Ton univers anime √† port√©e de clic</p>
      </div>
      <div class="controls">
        <div class="search-wrap">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M21 21l-4.35-4.35" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="11" cy="11" r="6" stroke="#9ca3af" stroke-width="2"></circle></svg>
          <input id="search" class="search" placeholder="Rechercher un anime..."/>
        </div>
        <select id="genre" class="select">
        </select>
        <select id="sort" class="select-sm">
          <option value="top">Top rating</option>
          <option value="new">Les plus r√©cents</option>
		  <option value="az">Alphab√©tique (A ‚Üí Z)</option>
		  <option value="za">Alphab√©tique (Z ‚Üí A)</option>
		  <option value="popular">üî• Popularit√©</option>
        </select>
        <select id="favFilter" class="select-sm">
          <option value="all">Tous</option>
          <option value="fav">Favoris seulement</option>
        </select>
      </div>
	  <div id="authContainer">
	    <div class="notif-container">
		  <i class="fa-solid fa-bell" id="notifBell"></i>
		  <span class="notif-badge" id="notifBadge">0</span>
		</div>
		<div class="notif-dropdown" id="notifDropdown" style="display:none;">
		  <ul id="notifList" style="list-style:none; margin:0; padding:0;"></ul>
		</div>
		<a href="profile.html" id="userBox">
          <span id="username"></span>
        </a>
		<button id="openLogin">Connexion</button>
		<button id="openSignup">Inscription</button>
	  </div>
	  <div id="authModal" class="modal-auth" style="display:none;">
	    <div class="modal-auth-content">
		  <h2 id="authTitle">Connexion</h2>

		  <input type="email" id="authEmail" placeholder="Email">
		  <input type="password" id="authPassword" placeholder="Mot de passe">

		  <button id="authSubmit">Valider</button>
		  <button id="authClose" class="close-auth">Fermer</button>
	    </div>
	  </div>
    </header>
	<div class="container">
    <main>
      <div id="grid" class="grid"></div>
      <div id="empty" style="display:none; color:var(--muted); text-align:center; padding:40px 0;">Aucun r√©sultat...</div>
    </main>

    <footer>Il manque ton anime ? N'h√©site pas √† demander pour que je le rajoute.</footer>
  </div>

  <!-- Modal template -->
  <div id="modalRoot" style="display:none"></div>
  <button id="backToTop">‚Üë Top</button>
  <script>
    const SAMPLE_ANIMES = [
      { id:1, 
	  title:'One Piece', 
	  genre:['Adventure','Action'], 
	  rating:0, 
	  year:1999, 
	  img:'https://cdn.myanimelist.net/images/anime/1244/138851.jpg', 
	  summary:'One Piece suit Monkey D. Luffy, un ado qui veut devenir Roi des Pirates apr√®s avoir mang√© un fruit magique qui rend son corps √©lastique. Il part sur les mers pour trouver le l√©gendaire tr√©sor, le One Piece, et se cr√©e petit √† petit un √©quipage aux pouvoirs et aux r√™ves diff√©rents, les Mugiwara. Ensemble, ils affrontent des pirates, des marines, des tyrans et des monstres, tout en vivant des aventures incroyables et en se rapprochant de la v√©rit√© sur le monde et sur le pass√© cach√©.', 
	  fav:false,
	  likes: 0},
      { id:2, 
	  title:'Solo Leveling', 
	  genre:['Action','Fantasy'], 
	  rating:0, 
	  year:2024, 
	  img:'https://cdn.myanimelist.net/images/anime/1448/147351.jpg', 
	  summary:'Dans un monde o√π des portails font appara√Ætre des monstres, les humains ‚Äúchasseurs‚Äù risquent leur vie pour les affronter. Sung Jin-Woo, consid√©r√© comme le chasseur le plus faible, survit par miracle √† un donjon terrifiant. Apr√®s √ßa, il re√ßoit un pouvoir unique : il peut devenir plus fort sans limite, comme dans un jeu vid√©o, en accomplissant des qu√™tes et en gagnant des niveaux. √Ä partir de l√†, Jin-Woo grimpe en puissance √† une vitesse folle, affronte des ennemis de plus en plus dangereux, et d√©couvre les secrets derri√®re les portails et sa propre ascension.', 
	  fav:false,
	  likes: 0 },
      { id:3, 
	  title:'Death Note', 
	  genre:['Mystery','Thriller'], 
	  rating:0, 
	  year:2006, 
	  img:'https://cdn.myanimelist.net/images/anime/1079/138100.jpg', 
	  summary:'Death Note raconte l‚Äôhistoire de Light Yagami, un √©tudiant japonais brillant mais d√©sabus√©, qui trouve un carnet surnaturel appel√© Death Note. Ce carnet permet de tuer toute personne dont on √©crit le nom dedans. Convaincu qu‚Äôil peut cr√©er un monde parfait en √©liminant les criminels, Light se transforme en justicier impitoyable sous le nom de Kira. Face √† lui, L, un d√©tective g√©nial et myst√©rieux, se lance dans une lutte intellectuelle intense pour l‚Äôarr√™ter. Entre manipulations, trahisons et strat√©gies mentales, le combat entre Light et L devient une v√©ritable partie d‚Äô√©checs mortelle.', 
	  fav:false,
	  likes: 0 },
      { id:4, 
	  title:'Jujutsu Kaisen', 
	  genre:['Action','Supernatural'], 
	  rating:0, 
	  year:2020, 
	  img:'https://cdn.myanimelist.net/images/anime/1180/153379.jpg', 
	  summary:'L‚Äôhistoire suit Yuji Itadori, un lyc√©en super sportif qui d√©couvre un monde cach√© rempli de mal√©dictions, des esprits cr√©√©s par les √©motions n√©gatives des humains. Quand il avale un doigt maudit contenant une puissante mal√©diction, Ryomen Sukuna, il devient son h√¥te. Yuji rejoint alors l‚Äô√©cole de Jujutsu, o√π il apprend √† combattre les mal√©dictions avec ses nouveaux pouvoirs, tout en essayant de prot√©ger les innocents et de d√©couvrir comment vaincre Sukuna d√©finitivement.', 
	  fav:false,
	  likes: 0  },
      { id:5, 
	  title:'Oshi No Ko', 
	  genre:['Drama','Mystery'], 
	  rating:0, 
	  year:2023, 
	  img:'https://cdn.myanimelist.net/images/anime/1979/153329.jpg', 
	  summary:'L‚Äôhistoire suit Aquamarine ‚ÄúAqua‚Äù et Ruby, des jumeaux n√©s dans l‚Äôindustrie du divertissement apr√®s une s√©rie d‚Äô√©v√©nements tragiques li√©s √† leur m√®re, une idole populaire. Le manga explore les coulisses sombres du showbiz, les ambitions, les manipulations et les secrets des c√©l√©brit√©s, tout en suivant leur qu√™te de justice et de v√©rit√© sur le pass√© de leur famille.', 
	  fav:false,
	  likes: 0 },
	  { id:6,
	  title:'Fairy Tail',
	  genre:['Action','Adventure','Fantasy'],
	  rating:0,
	  year:2009,
	  img:'https://cdn.myanimelist.net/images/anime/5/18179.jpg',
	  summary:`L'histoire suit Natsu Dragnir, un mage de feu, et ses amis de la guilde Fairy Tail, connus pour leur √©nergie, leur courage et leur sens de la camaraderie. Ensemble, ils accomplissent des missions, affrontent des ennemis redoutables et d√©couvrent des secrets sur le monde et sur eux-m√™mes. Au fil des aventures, l‚Äôanime met surtout l‚Äôaccent sur l‚Äôamiti√©, la pers√©v√©rance et la magie spectaculaire, avec des combats intenses et des moments √©mouvants qui renforcent les liens entre les personnages.`,
	  fav:false,
	  likes: 0 },
	  { id:7,
	  title:'Shangri-La Frontier',
	  genre:['Isekai','Fantasy','Game'],
	  rating:0,
	  year:2023,
	  img:'https://cdn.myanimelist.net/images/anime/1851/148885.jpg',
	  summary:`L'histoire suit Sunraku, un gamer hardcore qui adore les jeux vid√©o tout bugg√©s. Un jour, il d√©cide de tester Shangri-La Frontier, un VRMMORPG extr√™mement populaire et bien fait. Gr√¢ce √† son exp√©rience dans des jeux ‚Äúhorribles‚Äù, Sunraku devient incroyablement fort dans ce monde virtuel. Il se lance alors dans une aventure pleine de boss l√©gendaires, de d√©fis absurdes, de rencontres marquantes et de moments tr√®s dr√¥les, tout en essayant de percer les secrets du jeu.`,
	  fav:false,
	  likes: 0 },
	  { id:8,
	  title:'My Hero Academia',
	  genre:['Superheroes','Action'],
	  rating:0,
	  year:2016,
	  img:'https://cdn.myanimelist.net/images/anime/1959/151055.jpg',
	  summary:'Dans un monde o√π presque tout le monde poss√®de un pouvoir appel√© Alter, Izuku Midoriya na√Æt‚Ä¶ sans aucun pouvoir. Son r√™ve pourtant : devenir un grand h√©ros comme son idole All Might. Sa vie bascule quand All Might lui transmet son Alter, One For All. Izuku int√®gre alors l‚Äô√©cole de h√©ros UA, o√π il s‚Äôentra√Æne avec d‚Äôautres √©l√®ves pour devenir pro, affronte des vilains de plus en plus dangereux et d√©couvre les secrets derri√®re son nouveau pouvoir.',
	  fav:false,
	  likes: 0 },
	  { id:9,
	  title:'Attack On Titan',
	  genre:['Dark','Fantasy','Action','Drama'],
	  rating:0,
	  year:2013,
	  img:'https://cdn.myanimelist.net/images/anime/1948/120625.jpg',
	  summary:'L‚Äôhistoire suit Eren Yeager, qui vit dans une cit√© entour√©e de gigantesques murs pour prot√©ger l‚Äôhumanit√© des Titans, des cr√©atures qui d√©vorent les humains. Apr√®s que sa ville est d√©truite et que sa m√®re meurt, Eren jure d‚Äôexterminer tous les Titans. Il rejoint alors l‚Äôarm√©e avec Mikasa et Armin, et d√©couvre peu √† peu la v√©rit√© : les Titans, les murs, le monde ext√©rieur‚Ä¶ rien n‚Äôest vraiment comme on le leur a racont√©. L‚Äôhistoire devient une mont√©e en tension entre guerre, secrets et survie, o√π chaque r√©v√©lation change totalement la vision du monde.',
	  fav:false,
	  likes: 0 },
	  { id:10,
	  title:'Classroom Of The Elite',
	  genre:['Psychological','School Life','Drama','Thriller'],
	  rating:0,
	  year:2017,
	  img:'https://cdn.myanimelist.net/images/anime/1176/153626.jpg',
	  summary:'L‚Äôhistoire suit Kiyotaka Ayanok≈çji, un √©l√®ve apparemment banal plac√© dans la classe D, la classe la plus faible d‚Äôun lyc√©e d‚Äô√©lite o√π tout fonctionne selon un syst√®me de points, de comp√©tition et de manipulation. Tr√®s vite, on comprend qu‚ÄôAyanok≈çji cache un niveau d‚Äôintelligence et de strat√©gie monstrueux, qu‚Äôil utilise discr√®tement pour faire progresser sa classe, manipuler les autres groupes et naviguer dans un syst√®me scolaire impitoyable o√π chaque √©l√®ve cherche √† grimper socialement. L‚Äôanime repose sur des jeux psychologiques, des alliances, des trahisons, et les secrets autour du pass√© d‚ÄôAyanok≈çji.',
	  fav:false,
	  likes: 0 },
	  { id:11,
	  title:'Rascal Does Not Dream Of ...',
	  genre:['Romance','Drama','Psychological','Slice Of Life','Supernatural'],
	  rating:0,
	  year:2018,
	  img:'https://cdn.myanimelist.net/images/anime/1823/149858.jpg',
	  summary:'L‚Äôhistoire suit Sakuta Azusagawa, un lyc√©en qui rencontre Mai Sakurajima, une actrice c√©l√®bre devenue invisible aux yeux du monde √† cause d‚Äôun ph√©nom√®ne li√© au ‚Äúsyndrome de la pubert√©‚Äù. En cherchant √† l‚Äôaider, Sakuta d√©couvre que d‚Äôautres √©l√®ves vivent aussi des ph√©nom√®nes surnaturels qui refl√®tent leurs blessures √©motionnelles : harc√®lement, pression, jalousie, identit√©‚Ä¶ √Ä chaque fois, il doit comprendre leur probl√®me pour les aider √† s‚Äôen sortir, tout en d√©veloppant une relation touchante et sinc√®re avec Mai. C‚Äôest un anime qui m√©lange romance, √©motions et un soup√ßon de surnaturel de mani√®re tr√®s chill.',
	  fav:false,
	  likes: 0 },
	  { id:12,
	  title:'Your Lie In April',
	  genre:['Drama','Romance','Musical'],
	  rating:0,
	  year:2014,
	  img:'https://cdn.myanimelist.net/images/anime/1405/143284.jpg',
	  summary:'L‚Äôhistoire suit K≈çsei Arima, un ancien prodige du piano qui a compl√®tement arr√™t√© de jouer apr√®s la mort de sa m√®re. Il vit dans un monde ‚Äúsans couleurs‚Äù, incapable d‚Äôentendre la musique correctement. Sa vie change le jour o√π il rencontre Kaori Miyazono, une violoniste pleine d‚Äô√©nergie qui joue avec passion et libert√©. Gr√¢ce √† elle, K≈çsei se remet petit √† petit au piano, retrouve go√ªt √† la musique et commence √† gu√©rir de ses traumatismes‚Ä¶ mais Kaori cache un secret qui rend leur histoire encore plus bouleversante.',
	  fav:false,
	  likes: 0 },
	  { id:13,
	  title:'Kaguya-Sama : Love Is War',
	  genre:['Romance','Comedy','Psychological','School Life'],
	  rating:0,
	  year:2019,
	  img:'https://cdn.myanimelist.net/images/anime/1160/122627.jpg',
	  summary:'L‚Äôhistoire suit Kaguya Shinomiya et Miyuki Shirogane, les deux cadors du conseil des √©l√®ves, intelligents, respect√©s‚Ä¶ et secr√®tement amoureux l‚Äôun de l‚Äôautre. Sauf qu‚Äôils sont trop fiers pour avouer. Du coup, ils transforment chaque interaction en bataille mentale pour pousser l‚Äôautre √† craquer en premier : manipulations, pi√®ges psychologiques, strat√©gies ridicules‚Ä¶ tout y passe. Entre leurs plans qui tournent souvent au fiasco, l‚Äô√©nergie chaotique de Chika, et les probl√®mes des autres membres du conseil, la ‚Äúguerre‚Äù devient une romcom hilarante o√π avouer ses sentiments est l‚Äôobjectif final.',
	  fav:false,
	  likes: 0 },
	  { id:14,
	  title:'Hunter X Hunter',
	  genre:['Adventure','Action','Fantasy','Psychological'],
	  rating:0,
	  year:2011,
	  img:'https://cdn.myanimelist.net/images/anime/1337/99013.jpg',
	  summary:'L‚Äôhistoire suit Gon Freecss, un gar√ßon qui d√©couvre que son p√®re, qu‚Äôil croyait mort, est en r√©alit√© un Hunter l√©gendaire. Gon d√©cide de devenir lui aussi Hunter pour le retrouver. En chemin, il se lie d‚Äôamiti√© avec Killua, Leorio et Kurapika. Ensemble, ils passent des examens dangereux, affrontent des ennemis redoutables et explorent un monde rempli de cr√©atures, secrets et pouvoirs surnaturels. Les combats reposent souvent sur strat√©gie et intelligence, pas juste sur la force brute.',
	  fav:false,
	  likes: 0 },
	  { id:15,
	  title:'Fruits Basket',
	  genre:['Romance','Drama','Slice Of Life'],
	  rating:0,
	  year:2019,
	  img:'https://cdn.myanimelist.net/images/anime/1085/114792.jpg',
	  summary:'L‚Äôhistoire suit Tohru Honda, une lyc√©enne orpheline qui finit par vivre avec la famille Soma, maudite par le zodiaque chinois : chaque membre se transforme en animal lorsqu‚Äôil est stress√© ou en contact avec quelqu‚Äôun du sexe oppos√©. Au fil du temps, Tohru d√©couvre les secrets et blessures de chaque membre, les aide √† s‚Äôaccepter et gu√©rir, et cr√©e des liens forts d‚Äôamiti√© et de famille. L‚Äôanime m√©lange humour, √©motions et moments touchants tout au long de l‚Äôhistoire.',
	  fav:false,
	  likes: 0 },
	  { id:16,
	  title:'Chainsaw Man',
	  genre:['Dark','Fantasy','Action','Horror'],
	  rating:0,
	  year:2022,
	  img:'https://cdn.myanimelist.net/images/anime/1806/126216.jpg',
	  summary:'L‚Äôhistoire suit Denji, un jeune homme pauvre endett√©, qui chasse des d√©mons pour rembourser ses dettes. Apr√®s avoir √©t√© trahi et tu√©, il fusionne avec son chien-d√©mon Pochita et devient Chainsaw Man, capable de se transformer en humain avec des tron√ßonneuses sortant de son corps. Il rejoint alors l‚ÄôAgence des Chasseurs de D√©mons et combat des cr√©atures terrifiantes tout en d√©couvrant les v√©rit√©s sombres sur les d√©mons, les humains et ses propres d√©sirs. L‚Äôhistoire m√©lange action sanglante, humour noir et drame √©motionnel.',
	  fav:false,
	  likes: 0 },
	  { id:17,
	  title:'Tokyo Revengers',
	  genre:['Action','Drama','Time Travel'],
	  rating:0,
	  year:2021,
	  img:'https://cdn.myanimelist.net/images/anime/1340/148694.jpg',
	  summary:'L‚Äôhistoire suit Takemichi Hanagaki, un jeune homme rat√© qui apprend que son ex-petite amie de lyc√©e, Hinata, a √©t√© tu√©e par un gang. Un jour, il revient myst√©rieusement 12 ans dans le pass√© et d√©cide de changer le destin de Hinata en infiltrant et en remontant les rangs du gang Tokyo Manji. Au fil du temps, Takemichi se retrouve m√™l√© √† des bagarres, trahisons et alliances, tout en essayant de changer l‚Äôavenir et de prot√©ger ses amis. L‚Äôanime m√©lange action, drame et voyages dans le temps, avec un fort c√¥t√© √©motionnel.',
	  fav:false,
	  likes: 0 },
	  { id:18,
	  title:'Horimiya',
	  genre:['Romance','Slice Of Life','Comedy','School Life'],
	  rating:0,
	  year:2021,
	  img:'https://cdn.myanimelist.net/images/anime/1695/111486.jpg',
	  summary:'L‚Äôhistoire suit Hori, une lyc√©enne populaire et studieuse, et Miyamura, un camarade discret avec un c√¥t√© rebelle cach√©. Malgr√© leurs apparences publiques oppos√©es, ils d√©couvrent leur vrai visage l‚Äôun pour l‚Äôautre et deviennent amis puis amoureux. L‚Äôanime explore leur vie quotidienne au lyc√©e, les relations avec leurs amis, et la fa√ßon dont chacun apprend √† s‚Äôaccepter et √† se confier. C‚Äôest une romance douce, dr√¥le et touchante.',
	  fav:false,
	  likes: 0 },
	  { id:19,
	  title:'Blue Box',
	  genre:['Romance','Sports','Slice Of Life'],
	  rating:0,
	  year:2024,
	  img:'https://cdn.myanimelist.net/images/anime/1496/147108.jpg',
	  summary:'L‚Äôhistoire suit Taiki Inomata, un lyc√©en passionn√© de badminton, et Chinatsu Kano, une star du basketball dans le m√™me lyc√©e. Ils se rapprochent peu √† peu malgr√© leur timidit√© et les rivalit√©s sportives, d√©couvrant des sentiments naissants l‚Äôun pour l‚Äôautre. L‚Äôanime m√©lange romance douce, comp√©titions sportives et moments du quotidien, montrant comment leur passion pour le sport et leurs √©motions s‚Äôentrem√™lent.',
	  fav:false,
	  likes: 0 },
	  { id:20,
	  title:'The Angel Next Door Spoils Me Rotten',
	  genre:['Romance','Slice Of Life','School Life'],
	  rating:0,
	  year:2023,
	  img:'https://cdn.myanimelist.net/images/anime/1746/152415.jpg',
	  summary:'L‚Äôhistoire suit Amane Fujimiya, un lyc√©en ordinaire, et Mahiru Shiina, sa voisine parfaite et attentionn√©e, surnomm√©e ‚Äúl‚Äôange‚Äù. Mahiru commence √† prendre soin de Amane, que ce soit pour les repas, les v√™tements ou les petites attentions quotidiennes. Au fil du temps, leur proximit√© et leurs gestes tendres font na√Ætre des sentiments, et ils apprennent √† s‚Äôouvrir l‚Äôun √† l‚Äôautre tout en partageant des moments simples et touchants du quotidien.',
	  fav:false,
	  likes: 0 },
	  { id:21,
	  title:'Alya Sometimes Hides Her Feelings In Russian',
	  genre:['Comedy','Romance','Slice Of Life','School Life'],
	  rating:0,
	  year:2024,
	  img:'https://cdn.myanimelist.net/images/anime/1277/153378.jpg',
	  summary:'Dans une acad√©mie japonaise, il y a Alisa Mikhailovna Kujou (surnomm√©e ‚ÄúAlya‚Äù), une demi‚ÄëRusse demi‚ÄëJaponaise : belle, brillante et froide ‚Äî le genre ‚Äúprincesse inaccessible‚Äù. Elle s‚Äôassoit √† c√¥t√© d‚Äôun √©l√®ve un peu flemmard, Masachika Kuze, et malgr√© son attitude distante, Alya murmure parfois ‚Äî en russe ‚Äî des confidences et compliments adress√©s √† lui (pensant qu‚Äôil ne comprend pas). Masachika comprend parfaitement le russe, mais il fait semblant de ne rien piger. R√©sultat ? Une s√©rie de quiproquos, de regards g√™n√©s, de malentendus et de sentiments qui grandissent‚Ä¶ tout en douceur.',
	  fav:false,
	  likes: 0 },
	  { id:22,
	  title:'My Teen Romantic Comedy SNAFU',
	  genre:['Romance','Comedy','School Life','Slice Of Life','Psychological'],
	  rating:0,
	  year:2013,
	  img:'https://cdn.myanimelist.net/images/anime/1958/107912.jpg',
	  summary:'L‚Äôhistoire suit Hachiman Hikigaya, un lyc√©en cynique et solitaire, qui croit que les relations humaines sont superficielles. Pour ‚Äúapprendre la vie‚Äù, il est forc√© de rejoindre le Service Club, dirig√© par Yukino Yukinoshita, une fille brillante mais froide. Le club a pour mission d‚Äôaider les √©l√®ves avec leurs probl√®mes personnels. √Ä travers des situations sociales, des quiproquos et des d√©bats philosophiques, Hachiman et Yukino (avec l‚Äôaide de Yui Yuigahama) explorent les complexit√©s de l‚Äôamiti√©, de l‚Äôamour et des attentes sociales, souvent de mani√®re r√©aliste et pleine de sarcasme.',
	  fav:false,
	  likes: 0 },
	  { id:23,
	  title:'My First Girlfriend is a Gal',
	  genre:['Ecchi','Romance','Comedy','School Life'],
	  rating:0,
	  year:2017,
	  img:'https://cdn.myanimelist.net/images/anime/9/86826.jpg',
	  summary:'L‚Äôhistoire suit Junichi Hashiba, un lyc√©en timide qui n‚Äôa jamais eu de petite amie. Apr√®s avoir demand√© conseil √† ses amis, il finit par sortir avec Yukana Yame, une fille populaire et sexy, ce qui le plonge dans des situations g√™nantes, embarrassantes et dr√¥les. Au fil du temps, Junichi d√©couvre que Yukana n‚Äôest pas juste une ‚Äúgal superficielle‚Äù : elle a ses propres sentiments et failles. L‚Äôanime m√©lange romance, humour et moments un peu coquins, tout en montrant la croissance du couple.',
	  fav:false,
	  likes: 0 },
	  { id:24,
	  title:'Maid Sama!',
	  genre:['Romance','Comedy','School Life'],
	  rating:0,
	  year:2010,
	  img:'https://cdn.myanimelist.net/images/anime/6/25254.jpg',
	  summary:'L‚Äôhistoire suit Misaki Ayuzawa, pr√©sidente du conseil des √©l√®ves d‚Äôun lyc√©e auparavant r√©serv√© aux gar√ßons, connue pour sa rigueur et son s√©rieux. En secret, elle travaille dans un maid caf√© pour aider sa famille. Quand Takumi Usui, le gar√ßon le plus populaire du lyc√©e, d√©couvre son secret, il commence √† la taquiner tout en la soutenant. Au fil du temps, leur relation √©volue entre humour, romance et moments touchants, montrant comment Misaki apprend √† faire confiance et √† s‚Äôouvrir aux autres.',
	  fav:false,
	  likes: 0 },
	  { id:25,
	  title:`Don't Toys With Me, Miss Nagatoro`,
	  genre:['Comedy','Romance','School Life','Slice Of Life'],
	  rating:0,
	  year:2021,
	  img:'https://cdn.myanimelist.net/images/anime/1902/129579.jpg',
	  summary:'L‚Äôhistoire suit un lyc√©en timide, souvent appel√© Senpai, qui se fait taquiner et provoquer sans arr√™t par Nagatoro, une √©l√®ve plus jeune et tr√®s espi√®gle. Au fil des √©pisodes, leurs interactions passent du simple harc√®lement l√©ger √† une relation plus profonde et complice, o√π Nagatoro montre qu‚Äôelle tient vraiment √† lui, et o√π Senpai gagne en confiance. L‚Äôanime m√©lange humour, romance et moments mignons du quotidien scolaire.',
	  fav:false,
	  likes: 0 },
	  { id:26,
	  title:'The Fragrant Flower Blooms with Dignity',
	  genre:['Romance','Drama','School Life','Slice Of Life'],
	  rating:0,
	  year:2025,
	  img:'https://cdn.myanimelist.net/images/anime/1744/150433.jpg',
	  summary:'L‚Äôhistoire suit Rintar≈ç Tsumugi, un lyc√©en qui a l‚Äôair intimidant et rebelle ‚Äî mais en r√©alit√©, c‚Äôest un mec gentil et doux. Il travaille dans la boulangerie familiale. Un jour, il croise Kaoruko Waguri, une √©l√®ve d‚Äôun lyc√©e priv√© prestigieux pour filles, tr√®s diff√©rent de son √©cole. Elle ne le juge pas sur son apparence, et pour la premi√®re fois, Rintar≈ç sent qu‚Äôil pourrait exister quelqu‚Äôun qui le voit pour ce qu‚Äôil est vraiment. Malgr√© la rivalit√© entre leurs deux lyc√©es, ils apprennent √† se conna√Ætre, √† se rapprocher, √† d√©passer les pr√©jug√©s‚Ä¶ et √† construire peu √† peu une relation sinc√®re, faite de douceur, de petits gestes et de soutien mutuel. L‚Äôanime met l‚Äôaccent sur les √©motions vraies, la timidit√©, les doutes, les diff√©rences sociales et la beaut√© d‚Äôune romance ‚Äúnormale‚Äù mais touchante.',
	  fav:false,
	  likes: 0 },
	  { id:27,
	  title:'Cyberpunk : Edgerunners',
	  genre:['Action','Science Fiction','Cyberpunk','Drama'],
	  rating:0,
	  year:2022,
	  img:'https://cdn.myanimelist.net/images/anime/1818/126435.jpg',
	  summary:'L‚Äôhistoire suit David Martinez, un adolescent des rues dans la ville dystopique de Night City, obs√©d√© par la technologie et les implants cybern√©tiques. Apr√®s un tragique incident, il d√©cide de rejoindre un groupe de mercenaires appel√©s les Edgerunners pour survivre et s‚Äô√©lever dans ce monde cruel. Au fil de l‚Äôhistoire, David et son √©quipe affrontent des gangs, corporations et ennemis puissants, tout en explorant des th√®mes de loyaut√©, survie, ambition et humanit√© dans un univers violent et futuriste. L‚Äôanime combine action explosive, √©motion et trag√©die.',
	  fav:false,
	  likes: 0 },
	  { id:28,
	  title:'Romantic Killer',
	  genre:['Comedy','Romance','Slice Of Life','School Life','Supernatural'],
	  rating:0,
	  year:2022,
	  img:'https://cdn.myanimelist.net/images/anime/1764/142001.jpg',
	  summary:'L‚Äôh√©ro√Øne, Anzu Hoshino, est une lyc√©enne qui adore les jeux vid√©o, le chocolat et son chat ‚Äî mais n‚Äôa absolument aucun int√©r√™t pour l‚Äôamour ou les gar√ßons. Un jour, un sorcier bizarre nomm√© Riri d√©barque de nulle part et d√©cide qu‚ÄôAnzu doit vivre une ‚Äúsimulation de drague‚Äù en plein lyc√©e, entour√©e de plusieurs beaux gar√ßons. Pour la forcer √† tomber amoureuse, il lui enl√®ve ses trois passions : jeux vid√©o, chocolat et son chat. Anzu, qui ne veut surtout pas tomber dans un clich√© romantique, d√©cide alors de r√©sister de toutes ses forces. Mais plus l‚Äôhistoire avance, plus ses ‚Äúquasi‚Äërencontres‚Äù la poussent √† reconsid√©rer ce qu‚Äôelle veut vraiment‚Ä¶ et la romance forc√©e risque bien de devenir quelque chose de plus vrai que pr√©vu.',
	  fav:false,
	  likes: 0 },
	  { id:29,
	  title:'DanDaDan',
	  genre:['Action','Adventure','Supernatural','Horror','Comedy','Romance'],
	  rating:0,
	  year:2024,
	  img:'https://cdn.myanimelist.net/images/anime/1721/149001.jpg',
	  summary:'L‚Äôhistoire commence avec deux lyc√©ens : Momo Ayase, convaincue que les fant√¥mes existent, et Ken Takakura (surnomm√© ‚ÄúOkarun‚Äù), qui croit lui aux extraterrestres. Pour savoir lequel a raison, ils d√©cident de v√©rifier ‚Äî Momo explore un lieu suppos√© hant√©, Ken un spot d‚Äôovni. R√©sultat : ils ont tous les deux raison‚Ä¶ Fant√¥mes et extraterrestres sont r√©els, et ce qu‚Äôils d√©couvrent d√©passe l‚Äôhorreur et le WTF. √Ä partir de l√† ils se retrouvent embarqu√©s dans des aventures folles : exorcismes, batailles surnaturelles, cr√©atures bizarres, complots occultes, alli√©s improbables ‚Äî le tout dans un bordel coh√©rent, entre frissons, action et humour. En plus, entre deux monstres ou combats, y a des moments plus humains ‚Äî doutes, amiti√©, rapprochements ‚Äî ce qui donne un c√¥t√© √©pique + sensible √† l‚Äôhistoire.',
	  fav:false,
	  likes: 0 },
	  { id:30,
	  title:'Wistoria : Wand And Sword',
	  genre:['Fantasy','Adventure','Action'],
	  rating:0,
	  year:2024,
	  img:'https://cdn.myanimelist.net/images/anime/1428/154046.jpg',
	  summary:'On suit Will Serfort, un √©tudiant dans une acad√©mie magique appel√©e Rigarden Magical Academy. Son r√™ve : devenir un des plus puissants magiciens, les ‚ÄúMagia‚ÄØVander‚Äù, pour tenir une promesse faite √† son amie d‚Äôenfance. Le souci : Will n‚Äôa aucun talent pour la magie ‚Äî il ne peut lancer aucun sort. Du coup, il compense avec ses talents d‚Äô√©p√©iste : il entre dans l‚Äôacad√©mie et affronte des monstres dans des donjons avec son √©p√©e, esp√©rant prouver sa valeur malgr√© son absence de magie. Au fil des √©pisodes/chapitres, on d√©couvre que le monde dans lequel il vit est riche : magie, factions, monstres, √©cole magique, et enjeux lourds. Will se fait des alli√©s mais aussi des rivaux, et montre que m√™me sans magie, on peut se battre pour ses r√™ves ‚Äî avec courage et d√©termination.',
	  fav:false,
	  likes: 0 },
	  { id:31,
	  title:'Demon Slayer',
	  genre:['Action','Dark','Fantasy','Adventure'],
	  rating:0,
	  year:2019,
	  img:'https://cdn.myanimelist.net/images/anime/1565/142711.jpg',
	  summary:'L‚Äôhistoire suit Tanjiro Kamado, un jeune gar√ßon dont la famille a √©t√© massacr√©e par des d√©mons. Sa s≈ìur Nezuko est la seule survivante, mais elle a √©t√© transform√©e en d√©mon. Tanjiro d√©cide de devenir un Demon Slayer pour venger sa famille et trouver un moyen de rendre sa s≈ìur humaine. Accompagn√© de compagnons comme Zenitsu et Inosuke, il affronte des d√©mons puissants, d√©couvre les secrets de leur monde, et apprend ce que signifient courage, loyaut√© et compassion.',
	  fav:false,
	  likes: 0 },
	  { id:32,
	  title:'My Dress-Up Darling',
	  genre:['Romance','Comedy','Slice Of Life','School Life'],
	  rating:0,
	  year:2022,
	  img:'https://cdn.myanimelist.net/images/anime/1024/150787.jpg',
	  summary:'L‚Äôhistoire suit Wakana Gojo, un lyc√©en passionn√© par la confection de poup√©es traditionnelles mais tr√®s timide, et Marin Kitagawa, une camarade de classe extravertie et fan de cosplay. Marin d√©couvre le talent de Wakana pour cr√©er des costumes et lui demande de l‚Äôaider √† r√©aliser ses cosplays de r√™ve. Au fil du temps, leur collaboration les rapproche, et ils d√©couvrent une relation douce, dr√¥le et complice, entre rires, moments g√™nants et passions partag√©es.',
	  fav:false,
	  likes: 0 },
	  { id:33,
	  title:'Bleach',
	  genre:['Action','Adventure','Supernatural'],
	  rating:0,
	  year:2004,
	  img:'https://cdn.myanimelist.net/images/anime/1488/150890.jpg',
	  summary:'L‚Äôhistoire suit Ichigo Kurosaki, un lyc√©en capable de voir les fant√¥mes. Sa vie change lorsqu‚Äôil rencontre Rukia Kuchiki, une shinigami (Dieu de la mort), qui lui transf√®re ses pouvoirs pour qu‚Äôil prot√®ge sa famille et les vivants des Hollows, des esprits mal√©fiques. Ichigo devient alors un shinigami temporaire, combattant des ennemis puissants et d√©couvrant un monde spirituel complexe, tout en prot√©geant ses amis et en affrontant des dilemmes moraux. L‚Äôanime m√©lange action, aventures, drame et liens d‚Äôamiti√©.',
	  fav:false,
	  likes: 0},
	  { id:34,
	  title:'Sakamoto Days',
	  genre:['Action','Comedy','Slice Of Life'],
	  rating:0,
	  year:2025,
	  img:'https://cdn.myanimelist.net/images/anime/1758/148719.jpg',
	  summary:'Le perso principal, Taro Sakamoto, c‚Äô√©tait un tueur √† gages l√©gendaire, craint et respect√© dans le milieu. Mais un jour il tombe amoureux, d√©cide d‚Äôabandonner la vie d‚Äôassassin, se marie, a une fille, et ouvre une petite sup√©rette pour mener une vie tranquille. Il est devenu un mari/papa un peu rondouillard ‚Äî mais toujours costaud dans l‚Äô√¢me. Sauf que son pass√© le rattrape : d‚Äôanciens ennemis, des chasseurs de primes, des assassins reviennent pour lui. Pour prot√©ger sa famille, Sakamoto doit reprendre du service ‚Äî mais tout en essayant de garder sa promesse (ne plus tuer) et sa nouvelle vie paisible.',
	  fav:false,
	  likes: 0},
	  { id:35,
	  title:'Dragon Ball',
	  genre:['Action','Adventure','Fantasy'],
	  rating:0,
	  year:1986,
	  img:'https://cdn.myanimelist.net/images/anime/1723/145231.jpg',
	  summary:'L‚Äôhistoire suit Goku, un jeune gar√ßon dot√© d‚Äôune force surhumaine et d‚Äôune queue de singe. Il part √† l‚Äôaventure pour retrouver les Dragon Balls, sept boules magiques qui, une fois r√©unies, permettent de faire appara√Ætre le dragon Shenron et d‚Äôexaucer un v≈ìu. Au fil de ses voyages, Goku rencontre des amis comme Bulma, Krillin et Yamcha, affronte des ennemis redoutables, participe √† des tournois d‚Äôarts martiaux, et d√©couvre peu √† peu ses origines extraterrestres et ses incroyables pouvoirs. L‚Äôanime m√©lange action, humour, aventures et le√ßons sur l‚Äôamiti√© et le courage.',
	  fav:false,
	  likes: 0},
	  { id:36,
	  title:'Kaiju N¬∞8',
	  genre:['Action','Science Fiction'],
	  rating:0,
	  year:2024,
	  img:'https://cdn.myanimelist.net/images/anime/1177/150344.jpg',
	  summary:'L‚Äôhistoire suit Kafka Hibino, un homme de 32 ans qui r√™vait enfant de combattre les kaij≈´, des monstres g√©ants qui ravagent les villes. Mais apr√®s plusieurs √©checs, il travaille comme agent de nettoyage, charg√© d‚Äô√©liminer les restes des monstres apr√®s les combats. Tout change quand il se retrouve capable de se transformer en kaij≈´ lui-m√™me, devenant le myst√©rieux Kaiju N¬∞8. Coinc√© entre son r√™ve de rejoindre les Forces de D√©fense et le danger d‚Äô√™tre consid√©r√© comme un ennemi, Kafka doit cacher sa v√©ritable nature tout en prot√©geant l‚Äôhumanit√©. C‚Äôest un m√©lange d‚Äôaction, de tension, de d√©passement de soi et de moments plus humains.',
	  fav:false,
	  likes: 0},	  
	  { id:37,
	  title:'Fullmetal Alchemist Brotherhood',
	  genre:['Action','Fantasy','Adventure','Drama'],
	  rating:9.10,
	  year:2009,
	  img:'https://cdn.myanimelist.net/images/anime/1208/94745.jpg',
	  summary:'L‚Äôhistoire suit Edward et Alphonse Elric, deux fr√®res qui utilisent l‚Äôalchimie. Apr√®s avoir tent√© de ramener leur m√®re √† la vie par une transmutation interdite, ils en paient un prix terrible : Edward perd un bras et une jambe, et Alphonse perd tout son corps, son √¢me √©tant li√©e √† une armure. Pour retrouver leurs corps, ils partent √† la recherche de la Pierre Philosophale, en d√©couvrant peu √† peu les secrets sombres de leur pays, des complots, des guerres pass√©es et des ennemis appel√©s Homunculus. L‚Äôanime m√™le action, drame, √©motions fortes et une vraie r√©flexion sur le prix des choix humains.',
	  fav:false,
      likes: 0},
	  { id:38,
	  title:'One Punch Man',
	  genre:['Action','Superheroes','Comedy'],
	  rating:6.8,
	  year:2015,
	  img:'https://cdn.myanimelist.net/images/anime/1168/148347.jpg',
	  summary:'L‚Äôhistoire suit Saitama, un h√©ros tellement puissant qu‚Äôil bat tous ses ennemis‚Ä¶ en un seul coup. Apr√®s s‚Äô√™tre entra√Æn√© de mani√®re absurde, il cherche surtout √† retrouver un peu d‚Äôadr√©naline, car plus aucun combat ne lui procure de d√©fi. Il rejoint l‚ÄôAssociation des H√©ros, rencontre des alli√©s comme Genos, et affronte des monstres de plus en plus dangereux, tout en restant √©tonnamment inconnu et sous-estim√©. L‚Äôanime m√©lange action spectaculaire, humour absurde et parodie des sh≈çnen classiques.',
	  fav:false,
      likes: 0},
	  { id:39,
	  title:'Sword Art Online',
	  genre:['Isekai','Action','Science Fiction','Adventure','Romance'],
	  rating:7.3,
	  year:2012,
	  img:'https://cdn.myanimelist.net/images/anime/1335/145505.jpg',
	  summary:'L‚Äôhistoire suit Kirito, un joueur pi√©g√© avec des milliers d‚Äôautres personnes dans un jeu de r√©alit√© virtuelle appel√© Sword Art Online. Le probl√®me : mourir dans le jeu signifie mourir dans la vraie vie. Pour s‚Äô√©chapper, les joueurs doivent terminer les 100 niveaux du jeu. Kirito progresse en solo, affronte des boss puissants, rencontre Asuna, et tisse des liens forts tout en survivant dans ce monde dangereux. La s√©rie m√©lange action, aventure, drame et romance, en explorant les limites entre le virtuel et le r√©el.',
	  fav:false,
      likes: 0},
	  { id:40,
	  title:'Naruto',
	  genre:['Action','Adventure','Fantasy'],
	  rating:8.2,
	  year:2002,
	  img:'https://cdn.myanimelist.net/images/anime/1378/137310.jpg',
	  summary:'',
	  fav:false,
      likes: 0},
	  { id:41,
	  title:'Tokyo Ghoul',
	  genre:['Dark','Fantasy','Horror','Action','Drama'],
	  rating:6.9,
	  year:2014,
	  img:'https://cdn.myanimelist.net/images/anime/1545/121995.jpg',
	  summary:'L‚Äôhistoire suit Ken Kaneki, un √©tudiant timide qui devient √† moiti√© goule apr√®s une greffe d‚Äôorgane suite √† un accident. Il doit apprendre √† vivre dans un monde o√π humains et goules coexistent, tout en cachant sa v√©ritable identit√©. Kaneki rejoint les goules du caf√© ‚ÄúAnteiku‚Äù, apprend √† se d√©fendre, √† survivre, et d√©couvre la violence, la trahison et les dilemmes moraux qui existent entre les deux esp√®ces. L‚Äôanime m√©lange action, horreur, drame et questionnements sur l‚Äôidentit√© et l‚Äôhumanit√©.',
	  fav:false,
      likes: 0},
	  { id:42,
	  title:'Your Name.',
	  genre:['Romance','Fantasy','Drama','Slice Of Life'],
	  rating:8.8,
	  year:2016,
	  img:'https://cdn.myanimelist.net/images/anime/5/87048.jpg',
	  summary:'L‚Äôhistoire suit Mitsuha, une lyc√©enne vivant dans une petite ville de campagne, et Taki, un lyc√©en √† Tokyo. Un jour, ils d√©couvrent qu‚Äôils √©changent myst√©rieusement de corps pendant leur sommeil. Au fil du temps, ils apprennent √† mieux se conna√Ætre √† travers cette exp√©rience, cr√©ent des liens profonds et tentent de se retrouver malgr√© la distance et le temps, tout en faisant face √† un √©v√©nement tragique qui menace leur rencontre. L‚Äôanime m√©lange romance, √©motion, fantastique et suspense.',
	  fav:false,
      likes: 0},
	  { id:43,
	  title:'Steins;Gate',
	  genre:['Science Fiction','Thriller','Drama','Romance'],
	  rating:8.8,
	  year:2011,
	  img:'https://cdn.myanimelist.net/images/anime/1375/93521.jpg',
	  summary:'L‚Äôhistoire suit Rintarou Okabe, un scientifique excentrique qui d√©couvre avec ses amis comment envoyer des messages dans le pass√© gr√¢ce √† un micro-ondes modifi√©. Rapidement, ils r√©alisent que leurs exp√©riences d√©clenchent des changements dangereux dans le temps, attirant l‚Äôattention d‚Äôune organisation puissante. Okabe doit alors naviguer entre univers parall√®les, paradoxes temporels et pertes personnelles, tout en essayant de prot√©ger ses amis et de r√©parer les cons√©quences de leurs manipulations. L‚Äôanime m√™le science-fiction, suspense, drame et romance subtile.',
	  fav:false,
      likes: 0},
	  { id:44,
	  title:'A Silent Voice',
	  genre:['Drama','Romance','Slice Of Life'],
	  rating:8.9,
	  year:2016,
	  img:'https://cdn.myanimelist.net/images/anime/1122/96435.jpg',
	  summary:'L‚Äôhistoire suit Shoya Ishida, un gar√ßon qui a harcel√© Shoko Nishimiya, une √©l√®ve sourde, lorsqu‚Äôils √©taient enfants. En grandissant, Shoya ressent un profond remords et cherche √† se racheter. Il tente de reconnecter avec Shoko, de r√©parer ses erreurs et de trouver la paix avec lui-m√™me. L‚Äôanime explore le pardon, la culpabilit√©, l‚Äôamiti√©, l‚Äôacceptation de soi et des autres, avec beaucoup d‚Äô√©motion et de sensibilit√©.',
	  fav:false,
      likes: 0},
	  { id:45,
	  title:'No Game, No Life',
	  genre:['Fantasy','Isekai','Adventure','Comedy'],
	  rating:8,
	  year:2014,
	  img:'https://cdn.myanimelist.net/images/anime/1074/111944.jpg',
	  summary:'L‚Äôhistoire suit Sora et Shiro, un fr√®re et une s≈ìur prodiges des jeux vid√©o, invincibles en strat√©gie et en logique. Un jour, ils sont transport√©s dans un monde fantastique appel√© Disboard, o√π tous les conflits, du plus petit au plus grand, se r√®glent par des jeux √† enjeux √©lev√©s. Pour devenir les ma√Ætres de ce monde et d√©fier le myst√©rieux dieu Tet, ils doivent vaincre toutes sortes d‚Äôadversaires √† travers des jeux de toutes sortes, en combinant intelligence, ruse et audace. L‚Äôanime m√©lange action, humour, strat√©gie et moments d√©lirants.',
	  fav:false,
      likes: 0},
	  { id:46,
	  title:'Code Geass: Lelouch of the Rebellion',
	  genre:['Mecha','Science Fiction','Thriller','Drama'],
	  rating:8.8,
	  year:2006,
	  img:'https://cdn.myanimelist.net/images/anime/1088/135089.jpg',
	  summary:'L‚Äôhistoire suit Lelouch Lamperouge, un lyc√©en brillant vivant dans un monde domin√© par l‚ÄôEmpire de Britannia. Apr√®s avoir obtenu un pouvoir myst√©rieux appel√© le Geass, qui lui permet de donner un ordre absolu √† n‚Äôimporte qui, il d√©cide de renverser l‚ÄôEmpire pour cr√©er un monde meilleur pour sa s≈ìur. Sous le masque de Zero, Lelouch m√®ne une r√©bellion m√™lant strat√©gie, manipulation et combats de mechas, tout en faisant face √† des choix moraux difficiles et √† des sacrifices lourds. L‚Äôanime est connu pour son intensit√©, ses retournements de situation et sa fin l√©gendaire.',
	  fav:false,
      likes: 0},
	  { id:47,
	  title:'Re:Zero -Starting Life in Another World-',
	  genre:['Isekai','Dark','Fantasy','Drama','Thriller','Psychological'],
	  rating:8.4,
	  year:2016,
	  img:'https://cdn.myanimelist.net/images/anime/1040/153636.jpg',
	  summary:'L‚Äôhistoire suit Subaru Natsuki, un lyc√©en ordinaire soudainement transport√© dans un monde fantastique. Il d√©couvre rapidement qu‚Äôil poss√®de un pouvoir sp√©cial : revenir dans le temps √† chaque fois qu‚Äôil meurt, en repartant d‚Äôun point pr√©cis. Mais ce pouvoir a un prix √©norme : Subaru ressent toutes les douleurs physiques et mentales de ses morts, sans pouvoir en parler √† qui que ce soit. Coinc√© dans une boucle de souffrance, d‚Äô√©checs et de sacrifices, il tente de prot√©ger ceux qu‚Äôil aime, notamment Emilia, dans un univers impitoyable.',
	  fav:false,
      likes: 0}
	];
	

	const genreEl = document.getElementById('genre');
	const sortEl = document.getElementById('sort');
	const favFilterEl = document.getElementById('favFilter');
	const grid = document.getElementById('grid');
	const searchInput = document.getElementById('search');
	const empty = document.getElementById('empty');
	const modalRoot = document.getElementById('modalRoot');

	// Remplir select genres
	const genres = new Set(['Tout']);
	SAMPLE_ANIMES.forEach(a => a.genre.forEach(g => genres.add(g)));
	genres.forEach(g => { const o = document.createElement('option'); o.textContent=o.value=g; genreEl.appendChild(o); });
	
	const ITEMS_PER_LOAD = 6; // combien de cartes √† charger √† chaque fois
	let currentIndex = 0; // index de d√©part pour le rendu
	let filteredList = []; // liste filtr√©e apr√®s recherche/tri

	function openAnime(id) {
	  window.location.href = `anime.html?id=${id}`;
	}
	function renderList(list){
	  grid.innerHTML = '';
	  if(!list.length){ empty.style.display='block'; return; }
	  empty.style.display='none';

	  list.forEach((a, index) => {
		  const card = document.createElement('div'); 
		  card.className = 'card';
		  card.style.animationDelay = `${index * 0.08}s`; // 0.08s entre chaque carte
		  card.innerHTML = `
			<img src="${a.img}" alt="${a.title}">
			<div class="card-body">
			  <div class="meta"><div class="genres">${a.genre.join(' ‚Ä¢ ')}</div><div class="rating">${a.rating.toFixed(1)}</div></div>
			  <div class="title">${a.title}</div>
			  <div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px;">
				<div style="color:var(--muted); font-size:13px">${a.year}</div>
				<div style="display:flex; gap:6px;">
				  <button class="fav-btn" data-id="${a.id}">${a.fav?'‚òÖ':'‚òÜ'}</button>
				  <button onclick="openAnime(${a.id})">Voir</button>
				</div>
			  </div>
			</div>`;
		  grid.appendChild(card);
		});
	  // Modale et favoris
	  grid.querySelectorAll('.fav-btn').forEach(b => b.addEventListener('click', e=>{
		e.stopPropagation(); toggleFavorite(Number(b.dataset.id));
	  }));
	}
	function renderNextBatch() {
	  const grid = document.getElementById('grid');
	  if (currentIndex >= filteredList.length) return;

	  const nextBatch = filteredList.slice(currentIndex, currentIndex + ITEMS_PER_LOAD);
	  // R√©cup√©rer le genre depuis l'URL
	  const urlParams = new URLSearchParams(window.location.search);
	  const selectedGenre = urlParams.get('genre'); // ex: "Action"

	  // Si un genre est pr√©sent, filtrer la liste d√®s le d√©part
	  let filtered = SAMPLE_ANIMES; // animeList = ton tableau d'animes
	  if (selectedGenre) {
	    filteredSAMPLE_ANIMES = SAMPLE_ANIMES.filter(anime => anime.genre.includes(selectedGenre));
	  }
	  nextBatch.forEach((a, index) => {
		const card = document.createElement('div');
		card.className = 'card';
		card.style.animationDelay = `${(currentIndex + index) * 0.08}s`;

		card.innerHTML = `
		  <img src="${a.img}" alt="${a.title}">
		  <div class="card-body">
			<div class="meta">
			  <div class="genres">${a.genre.join(' ‚Ä¢ ')}</div>
			  <div class="rating">${a.rating.toFixed(1)}</div>
			</div>

			<div class="title">
			  ${a.title}
			  ${a.likes >= 3 ? `<span class="badge-trending">üî• Tendance</span>` : ''}
			</div>

			<div style="display:flex; justify-content:space-between; align-items:center; margin-top:10px;">
			  <div style="color:var(--muted); font-size:13px">${a.year}</div>

			  <div style="display:flex; gap:6px; align-items:center;">
				<div class="rating-box">
				  <select class="rate-select" data-id="${a.id}">
					<option value="">Noter</option>
					${Array.from({ length: 20 }, (_, i) => {
					  const val = (i + 1) * 0.5;
					  return `<option value="${val}">${val}</option>`;
					}).join('')}
				  </select>
				</div>
				<button class="fav-btn" data-id="${a.id}">${a.fav ? '‚òÖ' : '‚òÜ'}</button>
				<button class="btn" onclick="openAnime(${a.id})">Voir</button>
			  </div>
			</div>
		  </div>
		`;

		grid.appendChild(card);

		const select = card.querySelector('.rate-select');;
		
		// üîÅ Affichage de la note utilisateur au rechargement
		if (a.userRating !== null) {
		  select.value = a.userRating;
		}

		select.addEventListener('change', (e) => {
		  const animeId = Number(e.target.dataset.id);
		  const value = e.target.value;

		  // üî¥ suppression de la note
		  if (value === "") {
			removeRating(animeId);
			return;
		  }

		  // ‚≠ê ajout / modification
		  const rating = Number(value);
		  rateAnime(animeId, rating);
		});
	  });

	  currentIndex += ITEMS_PER_LOAD;
	  
	  // Afficher message si plus de r√©sultats
	  empty.style.display = currentIndex >= filteredList.length && filteredList.length === 0 ? 'block' : 'none';
	}
	function openModal(a){
	  modalRoot.innerHTML = `
		<div class="modal-backdrop" id="backdrop">
		  <div class="modal">
			<img src="${a.img}" alt="${a.title}">
			<div class="info">
			  <h2 style="margin:0 0 6px">${a.title}</h2>
			  <div style="color:var(--muted); margin-bottom:10px">
				${a.genre.join(' ‚Ä¢ ')} ‚Ä¢ ${a.year}
			  </div>
			  <p style="margin:0 0 12px; line-height:1.5; color:#dbeafe;">
				${a.summary}
			  </p>
			  <div style="display:flex; gap:8px; align-items:center">
				<div class="rating">${a.rating.toFixed(1)}</div>
				<button class="close" id="closeModal">Fermer</button>
			  </div>
			</div>
		  </div>
		</div>
	  `;

	  modalRoot.style.display = 'block';

	  document.getElementById('closeModal').onclick = closeModal;
	  document.getElementById('backdrop').onclick = (e) => {
		if (e.target.id === 'backdrop') closeModal();
	  };
	}

	function closeModal(){
	  modalRoot.style.display = 'none';
	  modalRoot.innerHTML = '';
	}
	// üîπ ouverture modale via URL (?anime=ID)
	const params = new URLSearchParams(window.location.search);
	const animeId = params.get("anime");

	if (animeId) {
	  const anime = SAMPLE_ANIMES.find(a => a.id == animeId);
	  if (anime && typeof openModal === "function") {
		openModal(anime);

		// optionnel : nettoyer l'URL
		window.history.replaceState({}, "", "index.html");
	  }
	}
	function applyFilters() {
	  const q = searchInput.value.toLowerCase();
	  const g = genreEl.value;
	  const s = sortEl.value;
	  const f = favFilterEl.value;

	  filteredList = SAMPLE_ANIMES.filter(a => a.title.toLowerCase().includes(q));
	  if(g !== 'Tout') filteredList = filteredList.filter(a => a.genre.includes(g));
	  if(f === 'fav') filteredList = filteredList.filter(a => a.fav);
	  if(s === 'top') filteredList.sort((a,b) => b.rating - a.rating);
	  if(s === 'new') filteredList.sort((a,b) => b.year - a.year);
	  if(s === 'az') filteredList.sort((a,b) => a.title.localeCompare(b.title));
	  if(s === 'za') filteredList.sort((a,b) => b.title.localeCompare(a.title));
	  if (s === 'popular') { filteredList.sort((a, b) => (b.likes || 0) - (a.likes || 0)); }
	  // reset
	  currentIndex = 0;
	  grid.innerHTML = '';
	  renderNextBatch();
	}
	searchInput.addEventListener('input', applyFilters);
	genreEl.addEventListener('change', applyFilters);
	sortEl.addEventListener('change', applyFilters);
	favFilterEl.addEventListener('change', applyFilters);
	
	const backToTop = document.getElementById('backToTop');
	window.addEventListener('scroll', () => {
	  if (window.scrollY > 50) {
		backToTop.classList.add('show');
		backToTop.classList.remove('hide');
	  } else {
		backToTop.classList.add('hide');
		setTimeout(() => backToTop.classList.remove('show'), 200);
	  }
	});
	backToTop.addEventListener('click', () => {
	  window.scrollTo({ top: 0, behavior: 'smooth' });
	});
	window.AnimeHub = { SAMPLE_ANIMES, renderList, applyFilters };
	window.addEventListener('scroll', () => {
	  if(window.scrollY > 20){
		document.querySelector('header').classList.add('sticky');
	  } else {
		document.querySelector('header').classList.remove('sticky');
	  }

	  // Infinite scroll
	  if(window.innerHeight + window.scrollY >= document.body.offsetHeight - 200) {
		renderNextBatch();
	  }
	});
	const authModal = document.getElementById("authModal");
	const authTitle = document.getElementById("authTitle");
	const authSubmit = document.getElementById("authSubmit");
	const authEmail = document.getElementById("authEmail");
	const authPassword = document.getElementById("authPassword");

	document.getElementById("openLogin").onclick = () => {
	  authTitle.textContent = "Connexion";
	  authSubmit.dataset.mode = "login";
	  authModal.style.display = "flex";
	};

	document.getElementById("openSignup").onclick = () => {
	  authTitle.textContent = "Inscription";
	  authSubmit.dataset.mode = "signup";
	  authModal.style.display = "flex";
	};

	document.getElementById("authClose").onclick = () => {
	  authModal.style.display = "none";
	};
	applyFilters();
  </script>
  <script type="module">
      import { 
          initializeApp 
      } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
      import { 
          getAuth, onAuthStateChanged, signOut 
      } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";
	  import { getFirestore, doc, getDoc, setDoc, updateDoc, arrayUnion, arrayRemove, increment, collection, getDocs, deleteField, query, where, orderBy, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";
	  
      const firebaseConfig = {
          apiKey: "AIzaSyCaJZi1Bn1vbeKOC5cM3Gi6nOFyWaH4NK4",
          authDomain: "animehub-7.firebaseapp.com",
          projectId: "animehub-7",
          storageBucket: "animehub-7.firebasestorage.app",
          messagingSenderId: "159114039206",
          appId: "1:159114039206:web:0461d676e7ffff25c4c967",
          measurementId: "G-6K4MB0XQEV"
      };

      const app = initializeApp(firebaseConfig);
      const userBox = document.getElementById("userBox");
      const username = document.getElementById("username");

      const openLogin = document.getElementById("openLogin");
      const openSignup = document.getElementById("openSignup");
	  const db = getFirestore(app);
	  const auth = getAuth(app);
	  const grid = document.getElementById("grid"); // ou le bon id
	  const notifBell = document.getElementById("notifBell");
	  const notifBadge = document.getElementById("notifBadge");
	  const notifDropdown = document.getElementById("notifDropdown");
	  const notifList = document.getElementById("notifList");
	  
	  let notifVisible = false;
	  
	  notifBell.addEventListener("click", () => {
	    notifVisible = !notifVisible;
	    notifDropdown.style.display = notifVisible ? "block" : "none";
	  });
	  userBox.addEventListener("click", () => {
        window.location.href = "profile.html";
      });

	  onAuthStateChanged(auth, async (user) => {
	    if (user) {
		  if (openLogin) openLogin.style.display = "none";
		  if (openSignup) openSignup.style.display = "none";
		  userBox.style.display = "flex";
		  await loadFavorites();
		  await loadPopularity();
		  await loadRatings();
		  await loadUserRatings();
		  await loadNotifications(user.uid);
		  applyFilters();

		  try {
		    const userDocRef = doc(db, "users", user.uid);
		    const userSnap = await getDoc(userDocRef);

		    if (userSnap.exists()) {
		      const data = userSnap.data();
			  username.textContent = data.username || user.email.split("@")[0];
		    } else {
			  // Cr√©e le doc Firestore si inexistant (utile pour comptes cr√©√©s avant Firestore)
			  const userData = {
			    username: user.email.split("@")[0],
			    email: user.email,
			    favorites: [],
			    ratings: {}
			  };
			  await setDoc(userDocRef, userData);
			  username.textContent = userData.username;
		    }

		  } catch (err) {
		    console.error("Erreur r√©cup√©ration Firestore:", err);
		    username.textContent = user.email.split("@")[0]; // fallback
		  }

	    } else {
		  if (openLogin) openLogin.style.display = "inline-block";
		  if (openSignup) openSignup.style.display = "inline-block";
		  userBox.style.display = "none";
		  window.location.href = "auth.html";
	    }
	  });
	  async function sendNotification(userId, title, message = "") {
	    try {
		  await addDoc(collection(db, "notifications"), {
		    userId: userId,
		    title: title,
		    message: message,
		    read: false,
		    createdAt: serverTimestamp()
		  });
		  await loadNotifications(userId);
	    } catch (err) {
		  console.error("Erreur notification:", err);
	    }
	  }

	  async function toggleFavorite(animeId) {
	    const user = auth.currentUser;
	    if (!user) {
		  alert("Connecte-toi pour ajouter un favori !");
		  return;
	   }

	    const anime = SAMPLE_ANIMES.find(a => a.id === animeId);
	    if (!anime) return;

	    const userRef = doc(db, "users", user.uid);
	    const animeRef = doc(db, "animes", String(animeId));

	    const wasFav = anime.fav;
	    anime.fav = !wasFav;

	    try {
		  // üîπ S'assurer que le doc anime existe
		  const snap = await getDoc(animeRef);
		  if (!snap.exists()) {
		    await setDoc(animeRef, { likes: 0 }, { merge: true });
		  }

		  // üîπ Mettre √† jour les favoris de l'utilisateur
		  if (!wasFav) {
		    await updateDoc(userRef, { favorites: arrayUnion(animeId) });
		    await updateDoc(animeRef, { likes: increment(1) });
			await sendNotification(user.uid, `Tu as ajout√© ${anime.title} √† tes favoris !`);
		  } else {
		    await updateDoc(userRef, { favorites: arrayRemove(animeId) });
		    await updateDoc(animeRef, { likes: increment(-1) });
		  }
	    } catch (err) {
		  console.error("Erreur toggleFavorite:", err);
	    }
		if (anime.likes === 3) {
		  sendNotificationToAllUsers(
			"üî• Anime tendance",
			anime.title
		  );
		}

	    // üîπ Mettre √† jour l'UI
	    const btn = document.querySelector(`.fav-btn[data-id="${animeId}"]`);
	    if (btn) btn.textContent = anime.fav ? "‚òÖ" : "‚òÜ";

	    applyFilters(); // refresh UI
	  }
	  
	  async function rateAnime(animeId, newRating) {
	    const user = auth.currentUser;
	    if (!user) {
		  alert("Connecte-toi pour noter un anime !");
		  return;
	    }

	    if (newRating < 0.5 || newRating > 10) return;

	    const userRef = doc(db, "users", user.uid);
	    const animeRef = doc(db, "animes", String(animeId));

	    try {
		  // üîπ R√©cup user
		  const userSnap = await getDoc(userRef);
		  if (!userSnap.exists()) return;

		  const userData = userSnap.data();
		  const oldRating = userData.ratings?.[animeId] ?? null;

		  // üîπ R√©cup anime
		  const animeSnap = await getDoc(animeRef);

		  let ratingSum = 0;
		  let ratingCount = 0;

		  if (animeSnap.exists()) {
		    const data = animeSnap.data();
		    ratingSum = data.ratingSum ?? 0;
		    ratingCount = data.ratingCount ?? 0;
		  }
 
		  // üîπ Cas 1 : premi√®re note
		  if (oldRating === null) {
		    ratingSum += newRating;
		    ratingCount += 1;
		  } 
		  // üîπ Cas 2 : modification de note
		  else {
		    ratingSum += (newRating - oldRating);
		  }

		  const avgRating = ratingSum / ratingCount;

		  // üîπ Update anime
		  await setDoc(animeRef, {
		    ratingSum,
		    ratingCount,
		    avgRating
		  }, { merge: true });

		  // üîπ Sauvegarde note utilisateur (1 seule par anime)
		  await updateDoc(userRef, {
		    [`ratings.${animeId}`]: newRating
		  });

		  // üîπ Update UI locale
		  const anime = SAMPLE_ANIMES.find(a => a.id === animeId);
		  if (anime) {
		    anime.rating = avgRating;
			anime.userRating = newRating;
		  }
		  if (oldRating === null) {
		    sendNotification(
			  user.uid,
			  "‚≠ê Premi√®re note !",
			  `Tu as not√© ${anime.title}`
		    );
		  }

		  if (oldRating !== null && oldRating !== newRating) {
		    sendNotification(
			  user.uid,
			  "üîÅ Note modifi√©e",
			  `${anime.title} : ${oldRating} ‚Üí ${newRating}`
		    );
		  }
		  // üîπ Objectif : 5 animes not√©s
		  const ratingCountUser = Object.keys(userData.ratings || {}).length + (oldRating === null ? 1 : 0);

		  if (ratingCountUser === 5) {
		    sendNotification(
			  user.uid,
			  "üèÜ Objectif atteint",
			  "5 animes not√©s !"
		    );
		  }

		  applyFilters(); // refresh affichage

	    } catch (err) {
		  console.error("Erreur rateAnime:", err);
	    }
	  }

	  window.rateAnime = rateAnime;
	  
	  async function removeRating(animeId) {
	    const user = auth.currentUser;
	    if (!user) return;

	    const userRef = doc(db, "users", user.uid);
	    const animeRef = doc(db, "animes", String(animeId));

	    try {
		  const userSnap = await getDoc(userRef);
		  if (!userSnap.exists()) return;

		  const userData = userSnap.data();
		  const oldRating = userData.ratings?.[animeId];
		  if (oldRating == null) return;

		  const animeSnap = await getDoc(animeRef);
		  if (!animeSnap.exists()) return;

		  const data = animeSnap.data();
		  let ratingSum = data.ratingSum ?? 0;
		  let ratingCount = data.ratingCount ?? 0;

		  // üîª retrait de la note
		  ratingSum -= oldRating;
		  ratingCount -= 1;

		  const update = ratingCount > 0
		    ? { ratingSum, ratingCount, avgRating: ratingSum / ratingCount }
		    : { ratingSum: 0, ratingCount: 0, avgRating: 0 };
 
		  await setDoc(animeRef, update, { merge: true });

		  // üîπ suppression c√¥t√© utilisateur
		  await updateDoc(userRef, {
		    [`ratings.${animeId}`]: deleteField()
		  });

		  // üîπ update UI locale (IMPORTANT)
		  const anime = SAMPLE_ANIMES.find(a => a.id === animeId);
		  if (anime) {
		    anime.userRating = null;
		    anime.rating = update.avgRating ?? 0;
		  }

		  // üî• AJOUT CRUCIAL : synchro filteredList
		 const filteredAnime = filteredList.find(a => a.id === animeId);
		  if (filteredAnime) {
		    filteredAnime.userRating = null;
		    filteredAnime.rating = update.avgRating ?? 0;
		  }
		  sendNotification(
		    user.uid,
		    "‚ùå Note supprim√©e",
		    anime.title
		  );

		  // üîπ mettre √† jour le select directement
		  const select = document.querySelector(`.rate-select[data-id="${animeId}"]`);
		  if (select) select.value = "";

		  applyFilters();

	    } catch (err) {
		  console.error("Erreur removeRating:", err);
	    }
	  }
	  
	  window.removeRating = removeRating;

	  // Modale
	  grid.addEventListener('click', e => {
	    if (e.target.classList.contains('btn')) {
		  const id = Number(e.target.dataset.id);
		  const anime = filteredList.find(a => a.id === id);
		  if (anime) openModal(anime);
	    }
	  });

	  // Favoris
	  grid.addEventListener('click', e => {
	   if (e.target.classList.contains('fav-btn')) {
		  e.stopPropagation();
		  const id = Number(e.target.dataset.id);
		  toggleFavorite(id);
	    }
	  });
	  async function loadFavorites() {
	    const user = auth.currentUser;
	    if (!user) return;

	    const userRef = doc(db, "users", user.uid);
	    const snap = await getDoc(userRef);

	    if (!snap.exists()) return;

	    const data = snap.data();
	    if (!Array.isArray(data.favorites)) return;

	    // üî• Synchronisation Firestore ‚Üí UI
	    SAMPLE_ANIMES.forEach(anime => {
		  anime.fav = data.favorites.includes(anime.id);
	    });
	  }
	  
	  async function loadPopularity() {
	    const snap = await getDocs(collection(db, "animes"));

	    snap.forEach(docSnap => {
		  const animeId = Number(docSnap.id);
		  const data = docSnap.data();

		  const anime = SAMPLE_ANIMES.find(a => a.id === animeId);
		  if (anime) {
		    anime.likes = data.likes ?? 0;
		  }
	    });
	  }
	  
	  async function loadRatings() {
	    const snap = await getDocs(collection(db, "animes"));

	    snap.forEach(docSnap => {
		  const animeId = Number(docSnap.id);
		  const data = docSnap.data();

		  const anime = SAMPLE_ANIMES.find(a => a.id === animeId);
		  if (anime && data.avgRating !== undefined) {
		    anime.rating = data.avgRating;
		  }
	    });
	  }
	  
	  async function loadUserRatings() {
	    const user = auth.currentUser;
	    if (!user) return;

	    const userRef = doc(db, "users", user.uid);
	    const snap = await getDoc(userRef);
	    if (!snap.exists()) return;

	    const ratings = snap.data().ratings || {};

	    SAMPLE_ANIMES.forEach(anime => {
	   	  anime.userRating = ratings[anime.id] ?? null;
	    });
	  }
	  
	  async function loadNotifications(userId) {
	    const notifCol = collection(db, "notifications");
	    const q = query(notifCol, where("userId", "==", userId), orderBy("createdAt", "desc"));
	    const snapshot = await getDocs(q);
	    notifList.innerHTML = "";
	  
	    let unreadCount = 0;
	  
	    snapshot.docs.forEach(docSnap => {
		  const notif = docSnap.data();
		  const li = document.createElement("li");
		  li.innerHTML = `
		    <strong>${notif.title}</strong><br>
		    <span style="font-size: 0.85em; opacity: 0.8;">
			  ${notif.message}
		    </span>
		  `;

		  // Si non lu, on peut mettre un style
		  if(!notif.read) {
		    li.style.fontWeight = "700";
		    unreadCount++;
		  }
		
		  li.addEventListener("click", async () => {
		    // Marquer comme lu
		    await updateDoc(doc(db, "notifications", docSnap.id), { read: true });
		    li.style.fontWeight = "400";
		    loadNotifications(userId); // reload pour mettre √† jour le badge
		  });
		
		  notifList.appendChild(li);
	    });
	  
	    notifBadge.textContent = unreadCount;
	    if(unreadCount > 0) notifBadge.classList.add("show");
	    else notifBadge.classList.remove("show");
	  }
	  async function sendNotificationToAllUsers(title, message = "") {
	    if (!title) {
		  console.warn("‚ùå Notification annul√©e : title manquant");
		  return;
	    }

	    const usersSnap = await getDocs(collection(db, "users"));
	    const promises = [];

	    usersSnap.forEach(userDoc => {
		  promises.push(
		    addDoc(collection(db, "notifications"), {
			  userId: userDoc.id,
			  title: title,
			  message: message,
			  read: false,
			  createdAt: serverTimestamp()
		    })
		  );
	    });

	    await Promise.all(promises);
	    console.log("‚úÖ Notification envoy√©e √† tous les utilisateurs");
	  }

	  async function sendSiteUpdateNotification(version, message) {
	    const metaRef = doc(db, "meta", "lastSiteUpdate");
	    const snap = await getDoc(metaRef);
 
	    // Emp√™che d'envoyer 2 fois la m√™me mise √† jour
	    if (snap.exists() && snap.data().version === version) return;

	    const usersSnap = await getDocs(collection(db, "users"));

	    const promises = [];
	    usersSnap.forEach(userDoc => {
	  	  promises.push(
		    addDoc(collection(db, "notifications"), {
			  userId: userDoc.id,
			  title: `üöÄ Mise √† jour du site (${version})`,
			  message: message,
			  read: false,
			  createdAt: serverTimestamp()
		    })
		  );
	    });

	    await Promise.all(promises);

	    await setDoc(metaRef, {
		  version,
		  createdAt: serverTimestamp()
	    });

	    console.log("‚úÖ Notification de mise √† jour envoy√©e");
	  }
	  async function notifyNewAnimeOnce(animeId, animeTitle) {
	    const metaRef = doc(db, "meta", `anime_${animeId}`);
	    const snap = await getDoc(metaRef);

	    // ‚õî D√©j√† notifi√© ‚Üí on stop
	    if (snap.exists()) return;

	    const usersSnap = await getDocs(collection(db, "users"));

	    const promises = [];
	    usersSnap.forEach(userDoc => {
		  promises.push(
		    addDoc(collection(db, "notifications"), {
			  userId: userDoc.id,
			  title: "üÜï Nouvel anime ajout√©",
			  message: animeTitle,
			  read: false,
			  createdAt: serverTimestamp()
		    })
	  	  );
	    });

	    await Promise.all(promises);

	    // üîí Marque cet anime comme "d√©j√† notifi√©"
	    await setDoc(metaRef, {
		  animeId,
		  animeTitle,
		  createdAt: serverTimestamp()
	    });

	    console.log(`‚úÖ Notification envoy√©e pour l'anime : ${animeTitle}`);
	  }

	  function updateFavoriteButtons() {
	    grid.querySelectorAll('.fav-btn').forEach(b => {
		  const id = Number(b.dataset.id);
		  const anime = filteredList.find(a => a.id === id);
		  if (anime && anime.isFavorite) {
		    b.classList.add('favorited'); // ou ton style CSS
		  } else {
		    b.classList.remove('favorited');
		  }
		})
	  };	
	  await sendNotificationToAllUsers
	  await sendSiteUpdateNotification;
	  await notifyNewAnimeOnce('47', 'Re:Zero -Starting Life in Another World-')
  </script>
</body>
</html>
