<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AnimeHub</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#9ca3af; --accent:#06b6d4;
      --glass: rgba(255,255,255,0.04);
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:linear-gradient(180deg,#0b1220 0%, #061226 100%); color:#e6eef6; -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}
    .container{max-width:1100px; margin:32px auto; padding:20px;}
    header{display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:18px;}
    h1{font-size:28px; margin:0}
    p.lead{color:var(--muted); margin:6px 0 0; font-size:14px}
    .controls{display:flex; gap:10px; align-items:center;}
    input.search{padding:10px 12px 10px 36px; border-radius:8px; border:1px solid rgba(255,255,255,0.06); background:var(--glass); color:inherit; min-width:220px;}
    .select, .select-sm{padding:9px 10px; border-radius:8px; background:transparent; border:1px solid rgba(255,255,255,0.06); color:inherit;}
    .grid{display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:16px; margin-top:18px;}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.06)); border-radius:12px; overflow:hidden; box-shadow: 0 6px 18px rgba(2,6,23,0.6); transition:transform .12s ease, box-shadow .12s ease;}
    .card:hover{transform:translateY(-6px); box-shadow:0 12px 30px rgba(2,6,23,0.8);}
    .card img{width:100%; height:300px; object-fit:cover; display:block; background:#111}
    .card-body{padding:12px;}
    .meta{display:flex; justify-content:space-between; align-items:center; gap:8px; color:var(--muted); font-size:13px}
    .title{font-weight:700; margin:8px 0 6px; font-size:16px}
    .genres{font-size:12px; color:var(--muted);}
    .btn{background:var(--accent); color:#052226; padding:8px 10px; border-radius:8px; border:none; cursor:pointer; font-weight:700;}
    .rating{background:rgba(0,0,0,0.45); padding:6px 8px; border-radius:8px; font-weight:700; font-size:13px;}
    .fav-btn{
      background:transparent;
      border:1px solid rgba(255,255,255,0.06);
      color:var(--accent);
      padding:6px 8px;
      border-radius:8px;
      cursor:pointer;
      font-weight:700;
      font-size:14px;
    }
	.select option, .select-sm option {color: #e6eef6;background-color: #0b1220
	}
	header {
	  display: flex;
	  align-items: center;
	  justify-content: space-between;
	  gap: 16px;
	  margin-bottom: 18px;

	  position: sticky; 
	  top: 0;             
	  z-index: 100;     
	  background: linear-gradient(180deg, rgba(11,18,32,0.95) 0%, rgba(6,18,38,0.95) 100%);
	  backdrop-filter: blur(6px); 
	}
	header {
	  transition: box-shadow 0.2s ease, background 0.2s ease;
	}
	header.sticky {
	  box-shadow: 0 4px 20px rgba(0,0,0,0.6);
	}
	header {
	  width: 100%;
	  padding: 40px 40px;
	  box-sizing: border-box;
	}
    /* modal */
    .modal-backdrop{position:fixed; inset:0; background:linear-gradient(90deg, rgba(2,6,23,0.6), rgba(2,6,23,0.85)); display:flex; align-items:center; justify-content:center; z-index:80; padding:20px;}
    .modal{max-width:900px; width:100%; background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(0,0,0,0.06)); border-radius:12px; padding:18px; display:flex; gap:16px; color:inherit;}
    .modal img{width:220px; height:320px; object-fit:cover; border-radius:8px}
    .modal .info{flex:1}
    .close{background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--muted); padding:6px 8px; border-radius:8px; cursor:pointer;}
    footer{text-align:center; color:var(--muted); margin-top:24px; font-size:13px}
    /* small screens */
    @media (max-width:720px){
      header{flex-direction:column; align-items:flex-start}
      .controls{width:100%; margin-top:10px; flex-wrap:wrap}
      .card img{height:220px}
      .modal{flex-direction:column; align-items:center}
      .modal img{width:180px; height:260px}
    }
    /* search icon */
    .search-wrap{position:relative}
    .search-wrap svg{position:absolute; left:10px; top:50%; transform:translateY(-50%); opacity:0.8}
	#backToTop {
	  position: fixed;
	  bottom: 22px;
	  right: 22px;
	  padding: 10px 14px;
	  font-size: 16px;
	  border-radius: 10px;
	  background: var(--accent);
	  color: #052226;
	  border: none;
	  cursor: pointer;
	  font-weight: 700;
	  display: none;
	  box-shadow: 0 6px 20px rgba(0,0,0,0.4);
	  transition: opacity .2s ease, transform .2s ease;
	}
	#backToTop.show {
	  display: block;
	  opacity: 1;
	  transform: translateY(0);
	}
	#backToTop.hide {
	  opacity: 0;
	  transform: translateY(10px);
	}
	@keyframes fadeUp {
	  0% {
		opacity: 0;
		transform: translateY(20px);
	  }
	  100% {
		opacity: 1;
		transform: translateY(0);
	  }
	}

	.card {
	  animation: fadeUp 0.4s ease forwards;
	}
	#authContainer {
	  display: flex;
	  gap: 8px;
	  align-items: center;
	  background: rgba(255,255,255,0.05);
	  padding: 6px 12px;
	  border-radius: 12px;
	  backdrop-filter: blur(4px);
	}

	#authContainer input {
	  padding: 6px 10px;
	  border-radius: 8px;
	  border: 1px solid rgba(255,255,255,0.1);
	  background: rgba(0,0,0,0.2);
	  color: #e6eef6;
	  outline: none;
	  font-size: 14px;
	  height: 36px;
	}

	#authContainer button {
	  padding: 0px 12px;
	  border-radius: 8px;
	  border: none;
	  cursor: pointer;
	  background: var(--accent);
	  color: #052226;
	  font-weight: 700;
	  transition: 0.2s;
	  height: 36px;
	}

	#authContainer button:hover {
	  background: #0fc1e5;
	}
	header {
	  padding: 20px 40px; /* au lieu de 40px */
	  flex-wrap: wrap;     /* permet aux √©l√©ments de descendre si besoin */
	}

	#authContainer {
	  display: flex;
	  gap: 8px;
	  align-items: center;
	  flex-wrap: wrap;     /* pour que les inputs passent √† la ligne sur mobile */
	}
	@media (max-width:720px){
	  #authContainer {
		width: 100%;
		justify-content: flex-start;
	  }
	  #authContainer input {
		flex: 1;  /* prend toute la largeur dispo */
	  }
	  #authContainer button {
		flex-shrink: 0;
	  }
	}
	#userBox {
	  background: rgba(255,255,255,0.05);
	  padding: 6px 12px;
	  border-radius: 8px;
	  color: var(--accent);
	  font-weight: 700;
	  display: flex;
	  align-items: center;
	  gap: 8px;
	}
	#authContainer {
	   flex-direction: column;
	}
	#authButtons {
	  display: flex;
	  flex-direction: column; 
	  gap: 6px;
	  width: 100%; /* pour que √ßa rende propre m√™me en r√©duit */
	}
	#authButtons button {
	  width: 100%;
	}
	.modal-auth {
	  position: fixed;
	  inset: 0;
	  background: rgba(0,0,0,0.65);
	  display: flex;
	  align-items: center;
	  justify-content: center;
	  z-index: 200;
	}

	.modal-auth-content {
	  background: var(--card);
	  padding: 20px;
	  border-radius: 12px;
	  width: 300px;
	  display: flex;
	  flex-direction: column;
	  gap: 12px;
	  animation: fadeUp .25s ease;
	}

	.modal-auth-content input {
	  padding: 10px;
	  border-radius: 8px;
	  border: 1px solid rgba(255,255,255,0.15);
	  background: var(--glass);
	  color: #fff;
	}

	.modal-auth-content button {
	  padding: 10px;
	  border-radius: 8px;
	  border: none;
	  cursor: pointer;
	  font-weight: 700;
	}

	.close-auth {
	  background: transparent;
	  border: 1px solid rgba(255,255,255,0.15);
	  color: var(--muted);
	}
  </style>
</head>
<body>
    <header>
      <div>
        <h1>AnimeHub</h1>
        <p class="lead">Ton univers anime √† port√©e de clic</p>
      </div>
      <div class="controls">
        <div class="search-wrap">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M21 21l-4.35-4.35" stroke="#9ca3af" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><circle cx="11" cy="11" r="6" stroke="#9ca3af" stroke-width="2"></circle></svg>
          <input id="search" class="search" placeholder="Rechercher un anime..." />
        </div>
        <select id="genre" class="select">
        </select>
        <select id="sort" class="select-sm">
          <option value="top">Top rating</option>
          <option value="new">Les plus r√©cents</option>
		  <option value="az">Alphab√©tique (A ‚Üí Z)</option>
		  <option value="za">Alphab√©tique (Z ‚Üí A)</option>
        </select>
        <select id="favFilter" class="select-sm">
          <option value="all">Tous</option>
          <option value="fav">Favoris seulement</option>
        </select>
      </div>
	  <div id="authContainer">
		<button id="openLogin">Connexion</button>
		<button id="openSignup">Inscription</button>

		<div id="userBox" style="display:none; align-items:center; gap:8px;">
		  <span id="username"></span>
		  <button id="logoutBtn">D√©connexion</button>
		</div>
	  </div>
	  <div id="authModal" class="modal-auth" style="display:none;">
	    <div class="modal-auth-content">
		  <h2 id="authTitle">Connexion</h2>

		  <input type="email" id="authEmail" placeholder="Email">
		  <input type="password" id="authPassword" placeholder="Mot de passe">

		  <button id="authSubmit">Valider</button>
		  <button id="authClose" class="close-auth">Fermer</button>
	    </div>
	  </div>
    </header>
	<div class="container">
    <main>
      <div id="grid" class="grid"></div>
      <div id="empty" style="display:none; color:var(--muted); text-align:center; padding:40px 0;">Aucun r√©sultat...</div>
    </main>

    <footer>Il manque ton anime ? N'h√©site pas √† demander pour que je le rajoute.</footer>
  </div>
	<script type="module">
		import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
		import { getAuth, onAuthStateChanged, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut } 
			   from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

		const firebaseConfig = {
			apiKey: "AIzaSyCaJZi1Bn1vbeKOC5cM3Gi6nOFyWaH4NK4",
			authDomain: "animehub-7.firebaseapp.com",
			projectId: "animehub-7",
			storageBucket: "animehub-7.firebasestorage.app",
			messagingSenderId: "159114039206",
			appId: "1:159114039206:web:0461d676e7ffff25c4c967",
			measurementId: "G-6K4MB0XQEV"
		};

		const app = initializeApp(firebaseConfig);
		const auth = getAuth(app);

		// üî• 1) Si l‚Äôutilisateur est d√©j√† connect√© ‚Üí Redirection auto
		onAuthStateChanged(auth, (user) => {
			if (user) {
				window.location.href = "index.html"; 
			}
		});

		// ----- POPUP -----
		const authModal = document.getElementById("authModal");
		const authEmail = document.getElementById("authEmail");
		const authPassword = document.getElementById("authPassword");
		const authSubmit = document.getElementById("authSubmit");

		let mode = "login"; 

		document.getElementById("openLogin").addEventListener("click", () => {
			mode = "login";
			document.getElementById("authTitle").textContent = "Connexion";
			authModal.style.display = "flex";
		});

		document.getElementById("openSignup").addEventListener("click", () => {
			mode = "signup";
			document.getElementById("authTitle").textContent = "Inscription";
			authModal.style.display = "flex";
		});

		// üî• VALIDER ‚Üí Connexion ou Inscription + Redirection
		authSubmit.addEventListener("click", async () => {
			const email = authEmail.value;
			const password = authPassword.value;

			try {
				let userCredential;

				if (mode === "login") {
					userCredential = await signInWithEmailAndPassword(auth, email, password);
				} else {
					userCredential = await createUserWithEmailAndPassword(auth, email, password);
				}

				// üî• Apr√®s validation ‚Üí Redirection vers la page principale
				window.location.href = "index.html";

			} catch (error) {
				alert("Erreur : " + error.message);
			}
		});

		document.getElementById("authClose").addEventListener("click", () => {
			authModal.style.display = "none";
		});
	</script>
